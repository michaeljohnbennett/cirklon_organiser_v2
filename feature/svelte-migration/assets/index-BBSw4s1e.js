var ll=Object.defineProperty;var ol=(e,t,n)=>t in e?ll(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var en=(e,t,n)=>ol(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(o){if(o.ep)return;o.ep=!0;const r=n(o);fetch(o.href,r)}})();function oe(){}function Xn(e){return e()}function rn(){return Object.create(null)}function Ie(e){e.forEach(Xn)}function Yn(e){return typeof e=="function"}function et(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function sl(e){return Object.keys(e).length===0}function Zn(e,...t){if(e==null){for(const l of t)l(void 0);return oe}const n=e.subscribe(...t);return n.unsubscribe?()=>n.unsubscribe():n}function il(e){let t;return Zn(e,n=>t=n)(),t}function xe(e,t,n){e.$$.on_destroy.push(Zn(t,n))}function s(e,t){e.appendChild(t)}function O(e,t,n){e.insertBefore(t,n||null)}function R(e){e.parentNode&&e.parentNode.removeChild(e)}function Ke(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function c(e){return document.createElement(e)}function X(e){return document.createTextNode(e)}function b(){return X(" ")}function gt(){return X("")}function I(e,t,n,l){return e.addEventListener(t,n,l),()=>e.removeEventListener(t,n,l)}function $t(e){return function(t){return t.preventDefault(),e.call(this,t)}}function i(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function rl(e){let t;return{p(...n){t=n,t.forEach(l=>e.push(l))},r(){t.forEach(n=>e.splice(e.indexOf(n),1))}}}function Jt(e){return e===""?null:+e}function cl(e){return Array.from(e.childNodes)}function ke(e,t){t=""+t,e.data!==t&&(e.data=t)}function ne(e,t){e.value=t??""}function B(e,t,n,l){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function Fe(e,t,n){for(let l=0;l<e.options.length;l+=1){const o=e.options[l];if(o.__value===t){o.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Ht(e){const t=e.querySelector(":checked");return t&&t.__value}function ce(e,t,n){e.classList.toggle(t,!!n)}let qt;function Kt(e){qt=e}function Qn(){if(!qt)throw new Error("Function called outside component initialization");return qt}function ul(e){Qn().$$.on_mount.push(e)}function al(e){Qn().$$.on_destroy.push(e)}function xt(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(l=>l.call(this,t))}const Ot=[],Xt=[];let zt=[];const cn=[],fl=Promise.resolve();let ln=!1;function ml(){ln||(ln=!0,fl.then($n))}function dt(e){zt.push(e)}const tn=new Set;let Rt=0;function $n(){if(Rt!==0)return;const e=qt;do{try{for(;Rt<Ot.length;){const t=Ot[Rt];Rt++,Kt(t),dl(t.$$)}}catch(t){throw Ot.length=0,Rt=0,t}for(Kt(null),Ot.length=0,Rt=0;Xt.length;)Xt.pop()();for(let t=0;t<zt.length;t+=1){const n=zt[t];tn.has(n)||(tn.add(n),n())}zt.length=0}while(Ot.length);for(;cn.length;)cn.pop()();ln=!1,tn.clear(),Kt(e)}function dl(e){if(e.fragment!==null){e.update(),Ie(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(dt)}}function pl(e){const t=[],n=[];zt.forEach(l=>e.indexOf(l)===-1?t.push(l):n.push(l)),n.forEach(l=>l()),zt=t}const Wt=new Set;let Mt;function Yt(){Mt={r:0,c:[],p:Mt}}function Zt(){Mt.r||Ie(Mt.c),Mt=Mt.p}function Me(e,t){e&&e.i&&(Wt.delete(e),e.i(t))}function He(e,t,n,l){if(e&&e.o){if(Wt.has(e))return;Wt.add(e),Mt.c.push(()=>{Wt.delete(e),l&&(n&&e.d(1),l())}),e.o(t)}else l&&l()}function ae(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function pt(e){e&&e.c()}function ct(e,t,n){const{fragment:l,after_update:o}=e.$$;l&&l.m(t,n),dt(()=>{const r=e.$$.on_mount.map(Xn).filter(Yn);e.$$.on_destroy?e.$$.on_destroy.push(...r):Ie(r),e.$$.on_mount=[]}),o.forEach(dt)}function ut(e,t){const n=e.$$;n.fragment!==null&&(pl(n.after_update),Ie(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function _l(e,t){e.$$.dirty[0]===-1&&(Ot.push(e),ml(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function at(e,t,n,l,o,r,u=null,a=[-1]){const m=qt;Kt(e);const f=e.$$={fragment:null,ctx:[],props:r,update:oe,not_equal:o,bound:rn(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:rn(),dirty:a,skip_bound:!1,root:t.target||m.$$.root};u&&u(f.root);let d=!1;if(f.ctx=n?n(e,t.props||{},(_,p,...h)=>{const k=h.length?h[0]:p;return f.ctx&&o(f.ctx[_],f.ctx[_]=k)&&(!f.skip_bound&&f.bound[_]&&f.bound[_](k),d&&_l(e,_)),p}):[],f.update(),d=!0,Ie(f.before_update),f.fragment=l?l(f.ctx):!1,t.target){if(t.hydrate){const _=cl(t.target);f.fragment&&f.fragment.l(_),_.forEach(R)}else f.fragment&&f.fragment.c();t.intro&&Me(e.$$.fragment),ct(e,t.target,t.anchor),$n()}Kt(m)}class ft{constructor(){en(this,"$$");en(this,"$$set")}$destroy(){ut(this,1),this.$destroy=oe}$on(t,n){if(!Yn(n))return oe;const l=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(t){this.$$set&&!sl(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const hl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(hl);const At=[];function sn(e,t=oe){let n;const l=new Set;function o(a){if(et(e,a)&&(e=a,n)){const m=!At.length;for(const f of l)f[1](),At.push(f,e);if(m){for(let f=0;f<At.length;f+=2)At[f][0](At[f+1]);At.length=0}}}function r(a){o(a(e))}function u(a,m=oe){const f=[a,m];return l.add(f),l.size===1&&(n=t(o,r)||oe),a(e),()=>{l.delete(f),l.size===0&&n&&(n(),n=null)}}return{set:o,update:r,subscribe:u}}var Bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},xn={exports:{}};(function(e,t){(function(n,l){l()})(Bt,function(){function n(f,d){return typeof d>"u"?d={autoBom:!1}:typeof d!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),d={autoBom:!d}),d.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(f.type)?new Blob(["\uFEFF",f],{type:f.type}):f}function l(f,d,_){var p=new XMLHttpRequest;p.open("GET",f),p.responseType="blob",p.onload=function(){m(p.response,d,_)},p.onerror=function(){console.error("could not download file")},p.send()}function o(f){var d=new XMLHttpRequest;d.open("HEAD",f,!1);try{d.send()}catch{}return 200<=d.status&&299>=d.status}function r(f){try{f.dispatchEvent(new MouseEvent("click"))}catch{var d=document.createEvent("MouseEvents");d.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),f.dispatchEvent(d)}}var u=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof Bt=="object"&&Bt.global===Bt?Bt:void 0,a=u.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),m=u.saveAs||(typeof window!="object"||window!==u?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(f,d,_){var p=u.URL||u.webkitURL,h=document.createElement("a");d=d||f.name||"download",h.download=d,h.rel="noopener",typeof f=="string"?(h.href=f,h.origin===location.origin?r(h):o(h.href)?l(f,d,_):r(h,h.target="_blank")):(h.href=p.createObjectURL(f),setTimeout(function(){p.revokeObjectURL(h.href)},4e4),setTimeout(function(){r(h)},0))}:"msSaveOrOpenBlob"in navigator?function(f,d,_){if(d=d||f.name||"download",typeof f!="string")navigator.msSaveOrOpenBlob(n(f,_),d);else if(o(f))l(f,d,_);else{var p=document.createElement("a");p.href=f,p.target="_blank",setTimeout(function(){r(p)})}}:function(f,d,_,p){if(p=p||open("","_blank"),p&&(p.document.title=p.document.body.innerText="downloading..."),typeof f=="string")return l(f,d,_);var h=f.type==="application/octet-stream",k=/constructor/i.test(u.HTMLElement)||u.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||h&&k||a)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var y=g.result;y=v?y:y.replace(/^data:[^;]*;/,"data:attachment/file;"),p?p.location.href=y:location=y,p=null},g.readAsDataURL(f)}else{var w=u.URL||u.webkitURL,D=w.createObjectURL(f);p?p.location=D:location.href=D,p=null,setTimeout(function(){w.revokeObjectURL(D)},4e4)}});u.saveAs=m.saveAs=m,e.exports=m})})(xn);var el=xn.exports;const bl="[-A-Za-z0-9()#. $@!&+{}*]",nn="Empty",Tt="MIDI CC",Dt="Track CTRL",gl=["pgm","quant%","note%","noteC","velo%","veloC","leng%","tbase","xpos","octave","knob1","knob2","fts-R","fts-S","reich"],vl=["1","2","3","4","5","usb1","usb2","usb3","usb4","usb5"];function un(){const e=new Date,t=String(e.getFullYear()).slice(-2),n=String(e.getMonth()+1).padStart(2,"0"),l=String(e.getDate()).padStart(2,"0"),o=String(Math.floor(Math.random()*100)).padStart(2,"0");return`${t}${n}${l}-${o} Cirklon Cfg`}function kl(){const{subscribe:e,set:t,update:n}=sn({name:un(),instruments:[],selectedInstrument:null,importInstrumentData:null});return{subscribe:e,reset:()=>t({name:un(),instruments:[],selectedInstrument:null,importInstrumentData:null}),setName:l=>n(o=>({...o,name:l||"Untitled Session"})),addInstrument:l=>n(o=>{let r=l.name;const u=o.instruments.map(f=>f.name);if(u.includes(r)){const f=r.match(/^(.+?)(\d+)$/);if(f){const d=f[1];let _=parseInt(f[2]);do _++,r=`${d}${_}`;while(u.includes(r))}else{let d=2;do r=`${l.name}${d}`,d++;while(u.includes(r))}}const a={...l,name:r},m=[...o.instruments,a];return{...o,instruments:m,selectedInstrument:a}}),deleteInstrument:l=>n(o=>{const r=o.instruments.filter(u=>u!==l);return{...o,instruments:r,selectedInstrument:r.length>0?r[0]:null}}),selectInstrument:l=>n(o=>({...o,selectedInstrument:l})),updateInstrument:l=>n(o=>{if(!o.selectedInstrument)return o;const r=o.instruments.findIndex(m=>m===o.selectedInstrument);if(r===-1)return o;const u={...o.selectedInstrument,...l},a=[...o.instruments];return a[r]=u,{...o,instruments:a,selectedInstrument:a[r]}}),replaceInstrument:l=>n(o=>{if(!o.selectedInstrument)return o;const r=o.instruments.findIndex(a=>a===o.selectedInstrument);if(r===-1)return o;const u=[...o.instruments];return u[r]=l,{...o,instruments:u,selectedInstrument:u[r]}}),setImportData:l=>n(o=>({...o,importInstrumentData:l})),clearImportData:()=>n(l=>({...l,importInstrumentData:null}))}}const x=kl(),Pt=sn(!1),Ut=sn(null);function an(e){return new RegExp("^"+bl+"{0,20}$").test(e)}function fn(e){return e>=1&&e<=16}function Cl(e){let t,n,l=e[2].name+"",o,r,u;return{c(){t=c("button"),n=c("span"),o=X(l),i(n,"class","label label-rounded logo session-label svelte-10fjwyl"),B(t,"cursor","pointer"),B(t,"border","none"),B(t,"background","transparent"),B(t,"padding","0"),i(t,"title","Click to edit session name"),i(t,"type","button")},m(a,m){O(a,t,m),s(t,n),s(n,o),r||(u=[I(t,"click",e[3]),I(t,"keydown",e[7])],r=!0)},p(a,m){m&4&&l!==(l=a[2].name+"")&&ke(o,l)},d(a){a&&R(t),r=!1,Ie(u)}}}function wl(e){let t,n,l;return{c(){t=c("input"),i(t,"type","search"),i(t,"class","form-input input-sm"),B(t,"width","200px"),B(t,"display","inline-block")},m(o,r){O(o,t,r),ne(t,e[1]),n||(l=[I(t,"input",e[6]),I(t,"blur",e[4]),I(t,"keydown",e[5])],n=!0)},p(o,r){r&2&&t.value!==o[1]&&ne(t,o[1])},d(o){o&&R(t),n=!1,Ie(l)}}}function Il(e){let t,n,l,o,r,u,a,m,f,d;function _(k,v){return k[0]?wl:Cl}let p=_(e),h=p(e);return{c(){t=c("header"),n=c("section"),l=c("div"),o=c("button"),r=X("Instruments"),a=b(),m=c("section"),h.c(),f=b(),d=c("section"),d.innerHTML='<a href="https://github.com/michaeljohnbennett/cirklon_organiser_v2" class="btn btn-sm">GitHub</a>',i(o,"class","btn btn-sm active badge"),i(o,"data-badge",u=e[2].instruments.length),i(l,"class","btn-group-block"),i(n,"class","navbar-section"),i(m,"class","navbar-center"),i(d,"class","navbar-section"),i(t,"class","navbar svelte-10fjwyl")},m(k,v){O(k,t,v),s(t,n),s(n,l),s(l,o),s(o,r),s(t,a),s(t,m),h.m(m,null),s(t,f),s(t,d)},p(k,[v]){v&4&&u!==(u=k[2].instruments.length)&&i(o,"data-badge",u),p===(p=_(k))&&h?h.p(k,v):(h.d(1),h=p(k),h&&(h.c(),h.m(m,null)))},i:oe,o:oe,d(k){k&&R(t),h.d()}}}function yl(e,t,n){let l;xe(e,x,_=>n(2,l=_));let o=!1,r="";function u(){n(1,r=l.name),n(0,o=!0)}function a(){r.trim()&&x.setName(r.trim()),n(0,o=!1)}function m(_){_.key==="Enter"?a():_.key==="Escape"&&n(0,o=!1)}function f(){r=this.value,n(1,r)}return[o,r,l,u,a,m,f,_=>_.key==="Enter"&&u()]}class Ml extends ft{constructor(t){super(),at(this,t,yl,Il,et,{})}}function on(e=null,t=""){const n=(e==null?void 0:e.continuousControls)||[];let l=Array(6).fill(null).map(()=>bt());return e!=null&&e.trackControls&&Array.isArray(e.trackControls)&&(l=e.trackControls.map(o=>{const r=bt(o);if(r.ccNumber!==void 0&&n.length>0){const u=n.find(a=>a.cc===r.ccNumber);u&&(r.continuousControl=u)}return r})),{name:(e==null?void 0:e.name)||t||"New Instrument",midiPort:(e==null?void 0:e.midiPort)||(e==null?void 0:e.midi_port)||"1",midiChannel:(e==null?void 0:e.midiChannel)||(e==null?void 0:e.midi_chan)||1,default_note:(e==null?void 0:e.default_note)||"C 3",default_patt:(e==null?void 0:e.default_patt)||"P3",multi:(e==null?void 0:e.multi)==="true"||(e==null?void 0:e.multi)===!0||!1,presend_pgm:(e==null?void 0:e.presend_pgm)==="on"||(e==null?void 0:e.presend_pgm)===!0||!1,poly_spread:(e==null?void 0:e.poly_spread)==="on"||(e==null?void 0:e.poly_spread)===!0||!1,no_bankL:(e==null?void 0:e.no_bankL)||!1,no_bankM:(e==null?void 0:e.no_bankM)||!1,no_xpose:(e==null?void 0:e.no_xpose)||!1,no_fts:(e==null?void 0:e.no_fts)||!1,show_note_nums:(e==null?void 0:e.show_note_nums)||!1,no_thru:(e==null?void 0:e.no_thru)||!1,continuousControls:n,trackControls:l,rowDefinitions:(e==null?void 0:e.rowDefinitions)||[],settings:(e==null?void 0:e.settings)||Tl(e,t)}}function Tl(e=null,t=""){return{name:(e==null?void 0:e.name)||t||"New Instrument",midiPort:(e==null?void 0:e.midiPort)||(e==null?void 0:e.midi_port)||"1",midiChannel:(e==null?void 0:e.midiChannel)||(e==null?void 0:e.midi_channel)||1}}function ht(e=null,t=null){return{cc:t!==null?t:(e==null?void 0:e.cc)||0,name:(e==null?void 0:e.name)||(e==null?void 0:e.label)||"",min:(e==null?void 0:e.min)!==void 0?e.min:0,max:(e==null?void 0:e.max)!==void 0?e.max:127,start:(e==null?void 0:e.start)!==void 0?e.start:0}}function bt(e=null,t=null){const n={name:(e==null?void 0:e.name)||"",continuousControl:t||null,trackValue:"",option:"Empty"};return e&&(e.hasOwnProperty("MIDI_CC")?(n.option="MIDI CC",n.ccNumber=e.MIDI_CC):e.hasOwnProperty("track_control")&&e.track_control!==null?(n.option="Track CTRL",n.trackValue=e.track_control):n.option="Empty"),n}function tl(e=null,t="C 3"){return{name:t,label:(e==null?void 0:e.label)||t,show:(e==null?void 0:e.always_show)||!1}}function Dl(e){if(!e||e.instruments.length===0){alert("No instruments to export!");return}const t={instrument_data:{}};e.instruments.forEach(r=>{const u=nl(r);t.instrument_data[r.name]=u});const n=JSON.stringify(t,null,"	"),l=new Blob([n],{type:"text/plain;charset=utf-8"}),o=(e.name||"session").replace(/[^a-z0-9_\-]/gi,"_").toLowerCase();el.saveAs(l,`${o}.CKI`),setTimeout(()=>{alert(`Session saved as "${o}.CKI" with ${e.instruments.length} instrument(s)`)},100)}function nl(e){const t={},n=t.CC_defs={};e.continuousControls.forEach(o=>{const r=`CC_${o.cc}`;n[r]={label:o.name,min_val:Number(o.min),max_val:Number(o.max),start_val:Number(o.min)}});const l=t.track_values={};if(e.trackControls.forEach((o,r)=>{const u=`slot_${r+1}`;o.option==="Track CTRL"?l[u]={track_control:o.trackValue}:o.option==="MIDI CC"&&o.continuousControl&&(l[u]={MIDI_CC:Number(o.continuousControl.cc),label:o.continuousControl.name})}),e.rowDefinitions&&e.rowDefinitions.length>0){const o=t.row_defs={};e.rowDefinitions.forEach(r=>{o[r.name]={label:r.label,always_show:r.show}})}return t.midi_port=e.midiPort,t.midi_chan=Number(e.midiChannel),t.default_note=e.default_note||"C 3",t.default_patt=e.default_patt||"P3",t.multi=e.multi?"true":"false",t.presend_pgm=e.presend_pgm?"on":"off",t.poly_spread=e.poly_spread?"on":"off",t.no_bankL=e.no_bankL||!1,t.no_bankM=e.no_bankM||!1,t.no_xpose=e.no_xpose||!1,t.no_fts=e.no_fts||!1,t.show_note_nums=e.show_note_nums||!1,t.no_thru=e.no_thru||!1,t}function Ll(e){const t=new FileReader;t.onload=n=>{try{const l=JSON.parse(n.target.result);if(l.hasOwnProperty("instrument_data")){const o=l.instrument_data,r=Object.keys(o);if(r.length===0){alert("No instruments found in file!");return}x.reset(),r.forEach(u=>{const a=Qt(o[u],u);x.addInstrument(a)}),alert(`Loaded ${r.length} instrument(s)`)}else alert("Invalid Cirklon instrument file!")}catch(l){console.error("Error loading file:",l),alert("Error loading file: "+l.message)}},t.readAsText(e)}function Nl(e){const t=new FileReader;t.onload=n=>{try{const l=JSON.parse(n.target.result);if(l.hasOwnProperty("instrument_data")){const o=l.instrument_data,r=Object.keys(o);if(r.length===0){alert("No instruments found in file!");return}if(r.length>1){const u=r.map(a=>({name:a,data:o[a],selected:!0}));Ut.set({instruments:u,file:e}),Pt.set(!0)}else{const u=r[0],a={data:o[u],name:u};x.setImportData(a),Pt.set(!0)}}else alert("Invalid Cirklon instrument file!")}catch(l){console.error("Error loading file:",l),alert("Error loading file: "+l.message)}},t.readAsText(e)}function Qt(e,t){const n=on(null,t);if(n.name=t,n.midiPort=String(e.midi_port||"1"),n.midiChannel=Number(e.midi_chan||1),n.default_note=e.default_note||"C 3",n.default_patt=e.default_patt||"P3",n.multi=e.multi==="true"||e.multi===!0,n.presend_pgm=e.presend_pgm==="on"||e.presend_pgm===!0,n.poly_spread=e.poly_spread==="on"||e.poly_spread===!0,n.no_bankL=e.no_bankL||!1,n.no_bankM=e.no_bankM||!1,n.no_xpose=e.no_xpose||!1,n.no_fts=e.no_fts||!1,n.show_note_nums=e.show_note_nums||!1,n.no_thru=e.no_thru||!1,console.log("Importing instrument:",t,"with midiPort:",n.midiPort,"and midiChannel:",n.midiChannel),e.CC_defs){const l=[];Object.keys(e.CC_defs).forEach(o=>{const r=e.CC_defs[o],u=parseInt(o.match(/\d+/g)[0]);l.push(ht(r,u))}),n.continuousControls=l}if(e.track_values){const l=[],o=e.track_values,r={};let u=0;Object.keys(o).forEach(f=>{const d=o[f],_=parseInt(f.match(/\d+/g)[0]);let p=null;d.MIDI_CC!==void 0&&(p=n.continuousControls.find(h=>h.cc===parseInt(d.MIDI_CC)),p||(p=ht({label:d.label},parseInt(d.MIDI_CC)),n.continuousControls.push(p))),r[_]=bt(d,p),u=Math.max(_,u)});const m=Math.ceil(u/6)*6;for(let f=1;f<=m;f++)l.push(r[f]||bt());n.trackControls=l}else n.trackControls=Array(6).fill(null).map(()=>bt());if(e.row_defs){const l=[];Object.keys(e.row_defs).forEach(o=>{l.push(tl(e.row_defs[o],o))}),n.rowDefinitions=l}return n}function El(e){e.forEach(t=>{if(t.selected){const n=Qt(t.data,t.name);x.addInstrument(n)}})}function Sl(e,t){if(!e||!e.data)return null;if(t==="new")return Qt(e.data,e.name);if(t==="merge"){const n=il(x);if(!n.selectedInstrument)return alert("No instrument selected to merge with!"),null;const l=Qt(e.data,e.name),o=n.selectedInstrument;return l.name&&(o.name=l.name),l.midiPort&&(o.midiPort=l.midiPort),l.midiChannel&&(o.midiChannel=l.midiChannel),l.default_note&&(o.default_note=l.default_note),l.default_pattern&&(o.default_pattern=l.default_pattern),l.continuousControls.forEach(r=>{const u=o.continuousControls.findIndex(a=>a.cc===r.cc);u!==-1?o.continuousControls[u]=r:o.continuousControls.push(r)}),l.rowDefinitions&&l.rowDefinitions.forEach(r=>{const u=o.rowDefinitions.findIndex(a=>a.name===r.name);u!==-1?o.rowDefinitions[u]=r:o.rowDefinitions.push(r)}),o}return null}function mn(e,t,n){const l=e.slice();return l[22]=t[n],l[24]=n,l}function dn(e,t,n){const l=e.slice();return l[25]=t[n],l}function pn(e){let t,n=e[3].selectedInstrument.name+"",l;return{c(){t=c("span"),l=X(n),i(t,"class","label label-rounded label-primary instrument-label svelte-eelyju")},m(o,r){O(o,t,r),s(t,l)},p(o,r){r&8&&n!==(n=o[3].selectedInstrument.name+"")&&ke(l,n)},d(o){o&&R(t)}}}function _n(e){let t,n,l,o,r,u,a,m;function f(...d){return e[19](e[25],...d)}return{c(){t=c("li"),n=c("button"),l=c("div"),l.textContent=`${e[25].name}`,o=b(),r=c("div"),r.textContent=`${e[25].description}`,u=b(),i(l,"class","template-name svelte-eelyju"),i(r,"class","template-desc svelte-eelyju"),i(n,"type","button"),i(n,"class","template-button svelte-eelyju"),i(t,"class","menu-item")},m(d,_){O(d,t,_),s(t,n),s(n,l),s(n,o),s(n,r),s(t,u),a||(m=I(n,"click",f),a=!0)},p(d,_){e=d},d(d){d&&R(t),a=!1,m()}}}function hn(e){let t,n=e[22].name+"",l;return{c(){t=c("option"),l=X(n),t.__value=e[24],ne(t,t.__value)},m(o,r){O(o,t,r),s(t,l)},p(o,r){r&8&&n!==(n=o[22].name+"")&&ke(l,n)},d(o){o&&R(t)}}}function jl(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C,M,L,S,q,Y,Q,T,K,te,F,Z,G,de,P,Te,De,Ce,se,_e,Ne,fe,Je,he=e[3].selectedInstrument&&pn(e),Ve=ae(e[4]),re=[];for(let J=0;J<Ve.length;J+=1)re[J]=_n(dn(e,Ve,J));let we=ae(e[3].instruments),pe=[];for(let J=0;J<we.length;J+=1)pe[J]=hn(mn(e,we,J));return{c(){t=c("input"),n=b(),l=c("input"),o=b(),r=c("div"),u=c("div"),a=c("section"),m=c("div"),f=c("div"),d=c("button"),d.textContent="New Session",_=b(),p=c("button"),p.textContent="Open",h=b(),k=c("button"),k.textContent="Save",v=b(),g=c("div"),he&&he.c(),w=b(),D=c("section"),y=c("div"),j=c("div"),H=c("button"),H.innerHTML='<i class="icon icon-bookmark"></i>',A=b(),z=c("ul");for(let J=0;J<re.length;J+=1)re[J].c();U=b(),C=c("button"),C.innerHTML='<i class="icon icon-upload btn-sm"></i>',M=b(),L=c("button"),S=c("i"),Y=b(),Q=c("button"),Q.innerHTML='<i class="icon icon-plus"></i>',T=b(),K=c("button"),te=c("i"),Z=b(),G=c("button"),de=c("i"),Te=b(),De=c("section"),Ce=c("div"),se=c("select");for(let J=0;J<pe.length;J+=1)pe[J].c();i(t,"type","file"),i(t,"accept",".json,.CKI"),B(t,"display","none"),i(l,"type","file"),i(l,"accept",".CKI"),B(l,"display","none"),i(d,"class","btn"),i(p,"class","btn tooltip svelte-eelyju"),i(p,"data-tooltip","Open session"),i(k,"class","btn tooltip svelte-eelyju"),i(k,"data-tooltip","Save session"),i(f,"class","btn-group btn-group-block"),i(m,"class","column col-auto"),i(g,"class","column"),B(g,"text-align","center"),i(a,"class","navbar-section columns"),i(H,"class","btn tooltip dropdown-toggle svelte-eelyju"),i(H,"data-tooltip","Load instrument template"),i(H,"type","button"),i(z,"class","menu template-menu svelte-eelyju"),i(j,"class","dropdown"),ce(j,"active",e[2]),i(C,"class","btn tooltip svelte-eelyju"),i(C,"data-tooltip","Import instrument"),i(S,"class","icon icon-download btn-sm"),i(L,"class","btn tooltip svelte-eelyju"),i(L,"data-tooltip","Export selected instrument"),L.disabled=q=!e[3].selectedInstrument,i(Q,"class","btn tooltip svelte-eelyju"),i(Q,"data-tooltip","Add new instrument"),i(te,"class","icon icon-copy"),i(K,"class","btn tooltip svelte-eelyju"),i(K,"data-tooltip","Duplicate selected instrument"),K.disabled=F=!e[3].selectedInstrument,i(de,"class","icon icon-minus"),i(G,"class","btn tooltip svelte-eelyju"),i(G,"data-tooltip","Delete selected instrument"),G.disabled=P=!e[3].selectedInstrument,i(y,"class","btn-group btn-group-block"),i(D,"class","navbar-center"),i(se,"class","form-select"),se.disabled=Ne=e[3].instruments.length<=1,i(Ce,"class","column"),i(De,"class","navbar-section"),i(u,"class","navbar"),i(r,"class","toolbar-container svelte-eelyju")},m(J,ue){O(J,t,ue),e[17](t),O(J,n,ue),O(J,l,ue),e[18](l),O(J,o,ue),O(J,r,ue),s(r,u),s(u,a),s(a,m),s(m,f),s(f,d),s(f,_),s(f,p),s(f,h),s(f,k),s(a,v),s(a,g),he&&he.m(g,null),s(u,w),s(u,D),s(D,y),s(y,j),s(j,H),s(j,A),s(j,z);for(let W=0;W<re.length;W+=1)re[W]&&re[W].m(z,null);s(y,U),s(y,C),s(y,M),s(y,L),s(L,S),s(y,Y),s(y,Q),s(y,T),s(y,K),s(K,te),s(y,Z),s(y,G),s(G,de),s(u,Te),s(u,De),s(De,Ce),s(Ce,se);for(let W=0;W<pe.length;W+=1)pe[W]&&pe[W].m(se,null);Fe(se,e[3].instruments.indexOf(e[3].selectedInstrument)),fe||(Je=[I(t,"change",e[8]),I(l,"change",e[11]),I(d,"click",e[5]),I(p,"click",e[7]),I(k,"click",e[6]),I(H,"click",e[16]),I(C,"click",e[10]),I(L,"click",e[14]),I(Q,"click",e[9]),I(K,"click",e[13]),I(G,"click",e[12]),I(se,"change",e[20])],fe=!0)},p(J,[ue]){if(J[3].selectedInstrument?he?he.p(J,ue):(he=pn(J),he.c(),he.m(g,null)):he&&(he.d(1),he=null),ue&32784){Ve=ae(J[4]);let W;for(W=0;W<Ve.length;W+=1){const Se=dn(J,Ve,W);re[W]?re[W].p(Se,ue):(re[W]=_n(Se),re[W].c(),re[W].m(z,null))}for(;W<re.length;W+=1)re[W].d(1);re.length=Ve.length}if(ue&4&&ce(j,"active",J[2]),ue&8&&q!==(q=!J[3].selectedInstrument)&&(L.disabled=q),ue&8&&F!==(F=!J[3].selectedInstrument)&&(K.disabled=F),ue&8&&P!==(P=!J[3].selectedInstrument)&&(G.disabled=P),ue&8){we=ae(J[3].instruments);let W;for(W=0;W<we.length;W+=1){const Se=mn(J,we,W);pe[W]?pe[W].p(Se,ue):(pe[W]=hn(Se),pe[W].c(),pe[W].m(se,null))}for(;W<pe.length;W+=1)pe[W].d(1);pe.length=we.length}ue&8&&_e!==(_e=J[3].instruments.indexOf(J[3].selectedInstrument))&&Fe(se,J[3].instruments.indexOf(J[3].selectedInstrument)),ue&8&&Ne!==(Ne=J[3].instruments.length<=1)&&(se.disabled=Ne)},i:oe,o:oe,d(J){J&&(R(t),R(n),R(l),R(o),R(r)),e[17](null),e[18](null),he&&he.d(),Ke(re,J),Ke(pe,J),fe=!1,Ie(Je)}}}function Rl(e,t,n){let l;xe(e,x,C=>n(3,l=C));let o,r;const u=[{file:"instrument-template.CKI",name:"Template - Full Setup",description:"Complete instrument with 38 CCs and track controls"}];let a=!1;function m(){confirm("Create new session? Unsaved changes will be lost.")&&x.reset()}function f(){Dl(l)}function d(){l.instruments.length>0&&!confirm("Load session? Unsaved changes will be lost.")||o.click()}function _(C){const M=C.target.files[0];M&&(Ll(M),C.target.value="")}function p(){const C=on();x.addInstrument(C)}function h(){r.click()}function k(C){const M=C.target.files[0];M&&(Nl(M),C.target.value="")}function v(){l.selectedInstrument&&confirm('Delete instrument "'+l.selectedInstrument.name+'"?')&&x.deleteInstrument(l.selectedInstrument)}function g(){if(!l.selectedInstrument)return;const C=l.selectedInstrument,M=JSON.parse(JSON.stringify(C)),L=C.name.match(/^(.+?)(\d+)$/);if(L){const S=L[1],q=parseInt(L[2]);M.name=`${S}${q+1}`}else M.name=`${C.name}2`;x.addInstrument(M)}function w(){if(!l.selectedInstrument)return;const C=l.selectedInstrument,M={instrument_data:{}};M.instrument_data[C.name]=nl(C);const L=JSON.stringify(M,null,"	"),S=new Blob([L],{type:"text/plain;charset=utf-8"}),q=C.name.replace(/[^a-z0-9_\-]/gi,"_").toLowerCase();el.saveAs(S,`${q}.CKI`),setTimeout(()=>{alert(`Instrument "${C.name}" exported as "${q}.CKI"`)},100)}async function D(C){console.log("Loading template:",C);try{const M=`/feature/svelte-migration/templates/${C}`,L=await fetch(M);console.log("Response:",L);const S=await L.json();console.log("Template data:",S);const q=on(S);console.log("New instrument:",q),x.addInstrument(q),console.log("Template loaded successfully")}catch(M){console.error("Failed to load instrument template:",M),alert("Failed to load template: "+M.message)}finally{n(2,a=!1)}}function y(C){C.stopPropagation(),console.log("Toggle dropdown, current state:",a),n(2,a=!a)}function j(C){a&&!C.target.closest(".dropdown")&&n(2,a=!1)}ul(()=>{window.addEventListener("click",j)}),al(()=>{window.removeEventListener("click",j)});function H(C){Xt[C?"unshift":"push"](()=>{o=C,n(0,o)})}function A(C){Xt[C?"unshift":"push"](()=>{r=C,n(1,r)})}return[o,r,a,l,u,m,f,d,_,p,h,k,v,g,w,D,y,H,A,(C,M)=>{M.stopPropagation(),console.log("Template button clicked:",C.file),D(C.file)},C=>{const M=parseInt(C.target.value);x.selectInstrument(l.instruments[M])}]}class Al extends ft{constructor(t){super(),at(this,t,Rl,jl,et,{})}}function bn(e,t,n){const l=e.slice();return l[36]=t[n],l}function gn(e,t,n){const l=e.slice();return l[39]=t[n],l}function Ol(e,t,n){const l=e.slice();return l[42]=t[n],l[44]=n,l}function Hl(e,t,n){const l=e.slice();return l[45]=t[n],l}function vn(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C,M,L,S,q,Y,Q,T,K,te,F,Z,G,de,P,Te,De,Ce,se,_e,Ne,fe,Je,he,Ve,re,we,pe,J,ue,W,Se,N,ee,be,ge,ie,ve,Le,Ee,Lt,Ze,vt,tt,We,Re,Nt,kt,Be,nt,ze,Ct,Et,wt,Ae,lt,Xe,Ue,St,Qe,It,ot,Ye,Oe,jt,yt,Pe,Ft,mt=ae(vl),$e=[];for(let E=0;E<mt.length;E+=1)$e[E]=zl(Hl(e,mt,E));let Vt=ae(Array(16)),Ge=[];for(let E=0;E<Vt.length;E+=1)Ge[E]=Pl(Ol(e,Vt,E));let st=ae(e[1]),ye=[];for(let E=0;E<st.length;E+=1)ye[E]=kn(gn(e,st,E));let it=ae(e[2]),je=[];for(let E=0;E<it.length;E+=1)je[E]=Cn(bn(e,it,E));return{c(){t=c("form"),n=c("div"),l=c("div"),o=c("div"),o.innerHTML='<label class="form-label" for="instrument-name">Name</label>',r=b(),u=c("div"),a=c("input"),m=b(),f=c("div"),d=c("div"),d.innerHTML='<label class="form-label" for="instrument-midi-port">MIDI port</label>',_=b(),p=c("div"),h=c("select");for(let E=0;E<$e.length;E+=1)$e[E].c();k=b(),v=c("div"),g=c("div"),g.innerHTML='<label class="form-label" for="instrument-midi-channel">MIDI channel</label>',w=b(),D=c("div"),y=c("select");for(let E=0;E<Ge.length;E+=1)Ge[E].c();j=b(),H=c("div"),A=c("div"),A.innerHTML='<label class="form-label" for="instrument-default-note">Default Note</label>',z=b(),U=c("div"),C=c("select");for(let E=0;E<ye.length;E+=1)ye[E].c();M=b(),L=c("div"),S=c("div"),S.innerHTML='<label class="form-label" for="instrument-default-pattern">Default Pattern</label>',q=b(),Y=c("div"),Q=c("select");for(let E=0;E<je.length;E+=1)je[E].c();T=b(),K=c("div"),te=b(),F=c("div"),Z=c("div"),G=c("div"),de=c("label"),P=c("input"),Te=b(),De=c("i"),Ce=X(" Multi"),se=b(),_e=c("label"),Ne=c("input"),fe=b(),Je=c("i"),he=X(" Presend pgm"),Ve=b(),re=c("label"),we=c("input"),pe=b(),J=c("i"),ue=X(" Poly Spread"),W=b(),Se=c("label"),N=c("input"),ee=b(),be=c("i"),ge=X(" No Bank L"),ie=b(),ve=c("label"),Le=c("input"),Ee=b(),Lt=c("i"),Ze=X(" No Bank M"),vt=b(),tt=c("label"),We=c("input"),Re=b(),Nt=c("i"),kt=X(" No XPose"),Be=b(),nt=c("label"),ze=c("input"),Ct=b(),Et=c("i"),wt=X(" No FTS"),Ae=b(),lt=c("label"),Xe=c("input"),Ue=b(),St=c("i"),Qe=X(" Show note nums"),It=b(),ot=c("label"),Ye=c("input"),Oe=b(),jt=c("i"),yt=X(" No Thru"),i(o,"class","col-3"),i(a,"id","instrument-name"),i(a,"class","form-input"),i(a,"type","search"),i(a,"placeholder","name"),i(a,"maxlength","9"),i(u,"class","col-9"),i(l,"class","form-group"),ce(l,"error",!an(e[0].name)),i(d,"class","col-3"),i(h,"id","instrument-midi-port"),i(h,"class","form-select"),e[0].midiPort===void 0&&dt(()=>e[8].call(h)),i(p,"class","col-9"),i(f,"class","form-group"),i(g,"class","col-3"),i(y,"id","instrument-midi-channel"),i(y,"class","form-select"),e[0].midiChannel===void 0&&dt(()=>e[10].call(y)),i(D,"class","col-9"),i(v,"class","form-group"),ce(v,"error",!fn(e[0].midiChannel)),i(A,"class","col-3"),i(C,"id","instrument-default-note"),i(C,"class","form-select"),e[0].default_note===void 0&&dt(()=>e[12].call(C)),i(U,"class","col-9"),i(H,"class","form-group"),i(S,"class","col-3"),i(Q,"id","instrument-default-pattern"),i(Q,"class","form-select"),e[0].default_patt===void 0&&dt(()=>e[14].call(Q)),i(Y,"class","col-9"),i(L,"class","form-group"),i(n,"class","col-7"),i(K,"class","divider-vert col-1"),i(P,"type","checkbox"),i(De,"class","form-icon"),i(de,"class","form-switch"),i(Ne,"type","checkbox"),i(Je,"class","form-icon"),i(_e,"class","form-switch"),i(we,"type","checkbox"),i(J,"class","form-icon"),i(re,"class","form-switch"),i(N,"type","checkbox"),i(be,"class","form-icon"),i(Se,"class","form-switch"),i(Le,"type","checkbox"),i(Lt,"class","form-icon"),i(ve,"class","form-switch"),i(We,"type","checkbox"),i(Nt,"class","form-icon"),i(tt,"class","form-switch"),i(ze,"type","checkbox"),i(Et,"class","form-icon"),i(nt,"class","form-switch"),i(Xe,"type","checkbox"),i(St,"class","form-icon"),i(lt,"class","form-switch"),i(Ye,"type","checkbox"),i(jt,"class","form-icon"),i(ot,"class","form-switch"),i(G,"class","col-12"),i(Z,"class","form-group"),i(F,"class","col-4"),i(t,"class","form-horizontal columns")},m(E,le){O(E,t,le),s(t,n),s(n,l),s(l,o),s(l,r),s(l,u),s(u,a),ne(a,e[0].name),s(n,m),s(n,f),s(f,d),s(f,_),s(f,p),s(p,h);for(let V=0;V<$e.length;V+=1)$e[V]&&$e[V].m(h,null);Fe(h,e[0].midiPort,!0),s(n,k),s(n,v),s(v,g),s(v,w),s(v,D),s(D,y);for(let V=0;V<Ge.length;V+=1)Ge[V]&&Ge[V].m(y,null);Fe(y,e[0].midiChannel,!0),s(n,j),s(n,H),s(H,A),s(H,z),s(H,U),s(U,C);for(let V=0;V<ye.length;V+=1)ye[V]&&ye[V].m(C,null);Fe(C,e[0].default_note,!0),s(n,M),s(n,L),s(L,S),s(L,q),s(L,Y),s(Y,Q);for(let V=0;V<je.length;V+=1)je[V]&&je[V].m(Q,null);Fe(Q,e[0].default_patt,!0),s(t,T),s(t,K),s(t,te),s(t,F),s(F,Z),s(Z,G),s(G,de),s(de,P),P.checked=e[0].multi,s(de,Te),s(de,De),s(de,Ce),s(G,se),s(G,_e),s(_e,Ne),Ne.checked=e[0].presend_pgm,s(_e,fe),s(_e,Je),s(_e,he),s(G,Ve),s(G,re),s(re,we),we.checked=e[0].poly_spread,s(re,pe),s(re,J),s(re,ue),s(G,W),s(G,Se),s(Se,N),N.checked=e[0].no_bankL,s(Se,ee),s(Se,be),s(Se,ge),s(G,ie),s(G,ve),s(ve,Le),Le.checked=e[0].no_bankM,s(ve,Ee),s(ve,Lt),s(ve,Ze),s(G,vt),s(G,tt),s(tt,We),We.checked=e[0].no_xpose,s(tt,Re),s(tt,Nt),s(tt,kt),s(G,Be),s(G,nt),s(nt,ze),ze.checked=e[0].no_fts,s(nt,Ct),s(nt,Et),s(nt,wt),s(G,Ae),s(G,lt),s(lt,Xe),Xe.checked=e[0].show_note_nums,s(lt,Ue),s(lt,St),s(lt,Qe),s(G,It),s(G,ot),s(ot,Ye),Ye.checked=e[0].no_thru,s(ot,Oe),s(ot,jt),s(ot,yt),Pe||(Ft=[I(a,"input",e[6]),I(a,"input",e[7]),I(h,"change",e[8]),I(h,"change",e[9]),I(y,"change",e[10]),I(y,"change",e[11]),I(C,"change",e[12]),I(C,"change",e[13]),I(Q,"change",e[14]),I(Q,"change",e[15]),I(P,"change",e[16]),I(P,"change",e[17]),I(Ne,"change",e[18]),I(Ne,"change",e[19]),I(we,"change",e[20]),I(we,"change",e[21]),I(N,"change",e[22]),I(N,"change",e[23]),I(Le,"change",e[24]),I(Le,"change",e[25]),I(We,"change",e[26]),I(We,"change",e[27]),I(ze,"change",e[28]),I(ze,"change",e[29]),I(Xe,"change",e[30]),I(Xe,"change",e[31]),I(Ye,"change",e[32]),I(Ye,"change",e[33]),I(t,"submit",$t(e[5]))],Pe=!0)},p(E,le){if(le[0]&1&&a.value!==E[0].name&&ne(a,E[0].name),le[0]&1&&ce(l,"error",!an(E[0].name)),le[0]&1&&Fe(h,E[0].midiPort),le[0]&1&&Fe(y,E[0].midiChannel),le[0]&1&&ce(v,"error",!fn(E[0].midiChannel)),le[0]&2){st=ae(E[1]);let V;for(V=0;V<st.length;V+=1){const _t=gn(E,st,V);ye[V]?ye[V].p(_t,le):(ye[V]=kn(_t),ye[V].c(),ye[V].m(C,null))}for(;V<ye.length;V+=1)ye[V].d(1);ye.length=st.length}if(le[0]&1&&Fe(C,E[0].default_note),le[0]&4){it=ae(E[2]);let V;for(V=0;V<it.length;V+=1){const _t=bn(E,it,V);je[V]?je[V].p(_t,le):(je[V]=Cn(_t),je[V].c(),je[V].m(Q,null))}for(;V<je.length;V+=1)je[V].d(1);je.length=it.length}le[0]&1&&Fe(Q,E[0].default_patt),le[0]&1&&(P.checked=E[0].multi),le[0]&1&&(Ne.checked=E[0].presend_pgm),le[0]&1&&(we.checked=E[0].poly_spread),le[0]&1&&(N.checked=E[0].no_bankL),le[0]&1&&(Le.checked=E[0].no_bankM),le[0]&1&&(We.checked=E[0].no_xpose),le[0]&1&&(ze.checked=E[0].no_fts),le[0]&1&&(Xe.checked=E[0].show_note_nums),le[0]&1&&(Ye.checked=E[0].no_thru)},d(E){E&&R(t),Ke($e,E),Ke(Ge,E),Ke(ye,E),Ke(je,E),Pe=!1,Ie(Ft)}}}function zl(e){let t;return{c(){t=c("option"),t.textContent=`${e[45]}`,t.__value=e[45],ne(t,t.__value)},m(n,l){O(n,t,l)},p:oe,d(n){n&&R(t)}}}function Pl(e){let t;return{c(){t=c("option"),t.textContent=`${e[44]+1}`,t.__value=e[44]+1,ne(t,t.__value)},m(n,l){O(n,t,l)},p:oe,d(n){n&&R(t)}}}function kn(e){let t,n=e[39]+"",l;return{c(){t=c("option"),l=X(n),t.__value=e[39],ne(t,t.__value)},m(o,r){O(o,t,r),s(t,l)},p:oe,d(o){o&&R(t)}}}function Cn(e){let t,n=e[36]+"",l;return{c(){t=c("option"),l=X(n),t.__value=e[36],ne(t,t.__value)},m(o,r){O(o,t,r),s(t,l)},p:oe,d(o){o&&R(t)}}}function Fl(e){let t,n=e[0]&&vn(e);return{c(){n&&n.c(),t=gt()},m(l,o){n&&n.m(l,o),O(l,t,o)},p(l,o){l[0]?n?n.p(l,o):(n=vn(l),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:oe,o:oe,d(l){l&&R(t),n&&n.d(l)}}}function Vl(e,t,n){let l,o;xe(e,x,P=>n(4,o=P));const r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],a=[0,1,2,3,4,5,6].flatMap(P=>r.map(Te=>`${Te} ${P}`)),m=["P3","CK"];function f(P,Te){x.updateInstrument({[P]:Te})}function d(P){xt.call(this,e,P)}function _(){l.name=this.value,n(0,l),n(4,o)}const p=P=>f("name",P.target.value);function h(){l.midiPort=Ht(this),n(0,l),n(4,o)}const k=P=>f("midiPort",P.target.value);function v(){l.midiChannel=Ht(this),n(0,l),n(4,o)}const g=P=>f("midiChannel",parseInt(P.target.value));function w(){l.default_note=Ht(this),n(0,l),n(4,o)}const D=P=>f("default_note",P.target.value);function y(){l.default_patt=Ht(this),n(0,l),n(4,o)}const j=P=>f("default_patt",P.target.value);function H(){l.multi=this.checked,n(0,l),n(4,o)}const A=P=>f("multi",P.target.checked);function z(){l.presend_pgm=this.checked,n(0,l),n(4,o)}const U=P=>f("presend_pgm",P.target.checked);function C(){l.poly_spread=this.checked,n(0,l),n(4,o)}const M=P=>f("poly_spread",P.target.checked);function L(){l.no_bankL=this.checked,n(0,l),n(4,o)}const S=P=>f("no_bankL",P.target.checked);function q(){l.no_bankM=this.checked,n(0,l),n(4,o)}const Y=P=>f("no_bankM",P.target.checked);function Q(){l.no_xpose=this.checked,n(0,l),n(4,o)}const T=P=>f("no_xpose",P.target.checked);function K(){l.no_fts=this.checked,n(0,l),n(4,o)}const te=P=>f("no_fts",P.target.checked);function F(){l.show_note_nums=this.checked,n(0,l),n(4,o)}const Z=P=>f("show_note_nums",P.target.checked);function G(){l.no_thru=this.checked,n(0,l),n(4,o)}const de=P=>f("no_thru",P.target.checked);return e.$$.update=()=>{e.$$.dirty[0]&16&&n(0,l=o.selectedInstrument)},[l,a,m,f,o,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C,M,L,S,q,Y,Q,T,K,te,F,Z,G,de]}class Bl extends ft{constructor(t){super(),at(this,t,Vl,Fl,et,{},null,[-1,-1])}}function wn(e,t,n){const l=e.slice();return l[54]=t[n],l}function In(e,t,n){const l=e.slice();return l[57]=t[n],l}function yn(e,t,n){const l=e.slice();return l[60]=t[n],l}function Mn(e){let t,n=ae(e[8]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Tn(yn(e,n,o));return{c(){t=c("ul");for(let o=0;o<l.length;o+=1)l[o].c();i(t,"class","menu cc-template-menu svelte-1ge1ink")},m(o,r){O(o,t,r);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(t,null)},p(o,r){if(r[0]&768){n=ae(o[8]);let u;for(u=0;u<n.length;u+=1){const a=yn(o,n,u);l[u]?l[u].p(a,r):(l[u]=Tn(a),l[u].c(),l[u].m(t,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=n.length}},d(o){o&&R(t),Ke(l,o)}}}function Tn(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k;function v(){return e[23](e[60])}function g(){return e[24](e[60])}return{c(){t=c("li"),n=c("div"),l=c("div"),o=c("span"),o.textContent=`${e[60].name}`,r=b(),u=c("span"),u.textContent=`${e[60].count} CCs`,a=b(),m=c("div"),f=c("button"),f.textContent="Merge",d=b(),_=c("button"),_.textContent="Replace",p=b(),i(o,"class","cc-template-name svelte-1ge1ink"),i(u,"class","cc-template-count svelte-1ge1ink"),i(l,"class","cc-template-info svelte-1ge1ink"),i(f,"class","btn btn-sm svelte-1ge1ink"),i(_,"class","btn btn-sm svelte-1ge1ink"),i(m,"class","cc-template-actions svelte-1ge1ink"),i(n,"class","cc-template-item svelte-1ge1ink"),i(t,"class","menu-item")},m(w,D){O(w,t,D),s(t,n),s(n,l),s(l,o),s(l,r),s(l,u),s(n,a),s(n,m),s(m,f),s(m,d),s(m,_),s(t,p),h||(k=[I(f,"click",v),I(_,"click",g)],h=!0)},p(w,D){e=w},d(w){w&&R(t),h=!1,Ie(k)}}}function Dn(e){let t,n=ae(e[7]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Ln(In(e,n,o));return{c(){t=c("ul");for(let o=0;o<l.length;o+=1)l[o].c();i(t,"class","menu cc-template-menu svelte-1ge1ink")},m(o,r){O(o,t,r);for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(t,null)},p(o,r){if(r[0]&1152){n=ae(o[7]);let u;for(u=0;u<n.length;u+=1){const a=In(o,n,u);l[u]?l[u].p(a,r):(l[u]=Ln(a),l[u].c(),l[u].m(t,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=n.length}},d(o){o&&R(t),Ke(l,o)}}}function Ln(e){let t,n,l,o,r=e[57].name+"",u,a,m,f=e[57].continuousControls.length+"",d,_,p,h,k,v,g,w,D,y;function j(){return e[26](e[57])}function H(){return e[27](e[57])}return{c(){t=c("li"),n=c("div"),l=c("div"),o=c("span"),u=X(r),a=b(),m=c("span"),d=X(f),_=X(" CCs"),p=b(),h=c("div"),k=c("button"),k.textContent="Merge",v=b(),g=c("button"),g.textContent="Replace",w=b(),i(o,"class","cc-template-name svelte-1ge1ink"),i(m,"class","cc-template-count svelte-1ge1ink"),i(l,"class","cc-template-info svelte-1ge1ink"),i(k,"class","btn btn-sm svelte-1ge1ink"),i(g,"class","btn btn-sm svelte-1ge1ink"),i(h,"class","cc-template-actions svelte-1ge1ink"),i(n,"class","cc-template-item svelte-1ge1ink"),i(t,"class","menu-item")},m(A,z){O(A,t,z),s(t,n),s(n,l),s(l,o),s(o,u),s(l,a),s(l,m),s(m,d),s(m,_),s(n,p),s(n,h),s(h,k),s(h,v),s(h,g),s(t,w),D||(y=[I(k,"click",j),I(g,"click",H)],D=!0)},p(A,z){e=A,z[0]&128&&r!==(r=e[57].name+"")&&ke(u,r),z[0]&128&&f!==(f=e[57].continuousControls.length+"")&&ke(d,f)},d(A){A&&R(t),D=!1,Ie(y)}}}function Nn(e){let t,n=ae(e[6]),l=[];for(let o=0;o<n.length;o+=1)l[o]=En(wn(e,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=gt()},m(o,r){for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(o,r);O(o,t,r)},p(o,r){if(r[0]&16449){n=ae(o[6]);let u;for(u=0;u<n.length;u+=1){const a=wn(o,n,u);l[u]?l[u].p(a,r):(l[u]=En(a),l[u].c(),l[u].m(t.parentNode,t))}for(;u<l.length;u+=1)l[u].d(1);l.length=n.length}},d(o){o&&R(t),Ke(l,o)}}}function En(e){let t,n,l=e[54].name+"",o,r,u,a=e[54].cc+"",m,f,d,_=e[54].min+"",p,h,k,v=e[54].max+"",g,w,D,y=e[54].start+"",j,H,A,z;function U(){return e[30](e[54])}return{c(){t=c("tr"),n=c("td"),o=X(l),r=b(),u=c("td"),m=X(a),f=b(),d=c("td"),p=X(_),h=b(),k=c("td"),g=X(v),w=b(),D=c("td"),j=X(y),H=b(),i(n,"class","svelte-1ge1ink"),i(u,"class","svelte-1ge1ink"),i(d,"class","svelte-1ge1ink"),i(k,"class","svelte-1ge1ink"),i(D,"class","svelte-1ge1ink"),B(t,"cursor","pointer"),i(t,"class","svelte-1ge1ink"),ce(t,"active",e[54]===e[0])},m(C,M){O(C,t,M),s(t,n),s(n,o),s(t,r),s(t,u),s(u,m),s(t,f),s(t,d),s(d,p),s(t,h),s(t,k),s(k,g),s(t,w),s(t,D),s(D,j),s(t,H),A||(z=I(t,"click",U),A=!0)},p(C,M){e=C,M[0]&64&&l!==(l=e[54].name+"")&&ke(o,l),M[0]&64&&a!==(a=e[54].cc+"")&&ke(m,a),M[0]&64&&_!==(_=e[54].min+"")&&ke(p,_),M[0]&64&&v!==(v=e[54].max+"")&&ke(g,v),M[0]&64&&y!==(y=e[54].start+"")&&ke(j,y),M[0]&65&&ce(t,"active",e[54]===e[0])},d(C){C&&R(t),A=!1,z()}}}function Ul(e){let t,n,l;return{c(){t=c("button"),t.textContent="Add new",i(t,"type","button"),i(t,"class","btn btn-sm btn-primary tooltip"),i(t,"data-tooltip","Add new continuous control to list.")},m(o,r){O(o,t,r),n||(l=I(t,"click",e[16]),n=!0)},p:oe,d(o){o&&R(t),n=!1,l()}}}function Kl(e){let t,n,l,o,r;return{c(){t=c("button"),t.textContent="Delete",n=b(),l=c("button"),l.textContent="Add New",i(t,"type","button"),i(t,"class","btn btn-sm btn-error tooltip"),i(t,"data-tooltip","Delete selected continuous control from list."),i(l,"type","button"),i(l,"class","btn btn-sm tooltip"),i(l,"data-tooltip","Clear selection and add new continuous control.")},m(u,a){O(u,t,a),O(u,n,a),O(u,l,a),o||(r=[I(t,"click",e[17]),I(l,"click",e[49])],o=!0)},p:oe,d(u){u&&(R(t),R(n),R(l)),o=!1,Ie(r)}}}function Sn(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U;return{c(){t=c("div"),n=c("button"),l=b(),o=c("div"),r=c("div"),r.innerHTML='<div class="modal-title h6" style="font-size: 0.8rem;">Track Controls Warning</div>',u=b(),a=c("div"),m=c("div"),f=c("p"),d=X("Your Track Controls currently use MIDI CCs. Importing from "),_=c("strong"),p=X(e[5]),h=X(" will:"),k=b(),v=c("ul"),v.innerHTML=`<li>Re-link Track Controls to matching CC numbers if they exist in the
              import</li> <li>Set Track Controls to null if their CC numbers are not in the
              import</li> <li>Keep Track Control configuration (names and settings) intact</li>`,g=b(),w=c("p"),w.textContent="Continue with import?",D=b(),y=c("div"),j=c("button"),j.textContent="Continue",H=b(),A=c("button"),A.textContent="Cancel",i(n,"class","modal-overlay"),i(n,"aria-label","Close modal"),i(n,"type","button"),i(r,"class","modal-header"),B(f,"font-size","0.75rem"),B(f,"margin-bottom","0.5rem"),B(v,"font-size","0.7rem"),B(v,"margin-left","1rem"),B(v,"margin-bottom","0.5rem"),B(w,"font-size","0.75rem"),B(w,"color","#e85600"),B(w,"font-weight","600"),i(m,"class","content"),i(a,"class","modal-body"),i(j,"class","btn btn-sm btn-primary svelte-1ge1ink"),B(j,"font-size","0.75rem"),i(A,"class","btn btn-sm svelte-1ge1ink"),B(A,"font-size","0.75rem"),i(y,"class","modal-footer svelte-1ge1ink"),i(o,"class","modal-container svelte-1ge1ink"),i(o,"role","document"),i(t,"class","modal modal-sm active svelte-1ge1ink")},m(C,M){O(C,t,M),s(t,n),s(t,l),s(t,o),s(o,r),s(o,u),s(o,a),s(a,m),s(m,f),s(f,d),s(f,_),s(_,p),s(f,h),s(m,k),s(m,v),s(m,g),s(m,w),s(o,D),s(o,y),s(y,j),s(y,H),s(y,A),z||(U=[I(n,"click",e[12]),I(j,"click",e[11]),I(A,"click",e[12])],z=!0)},p(C,M){M[0]&32&&ke(p,C[5])},d(C){C&&R(t),z=!1,Ie(U)}}}function ql(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C=e[6].length+"",M,L,S,q,Y,Q,T,K,te,F,Z,G,de,P,Te,De,Ce,se,_e,Ne,fe,Je,he=e[0]?"Edit":"New",Ve,re,we,pe,J,ue,W,Se,N,ee,be,ge,ie,ve,Le,Ee,Lt,Ze,vt,tt,We,Re,Nt,kt,Be,nt,ze,Ct,Et,wt,Ae,lt,Xe,Ue,St,Qe,It,ot,Ye,Oe,jt,yt,Pe,Ft,mt,$e,Vt,Ge,st,ye,it,je,E=e[2]&&Mn(e),le=e[3]&&Dn(e),V=e[6].length>0&&Nn(e);function _t($,me){return $[0]?Kl:Ul}let Gt=_t(e),rt=Gt(e),qe=e[4]&&Sn(e);return{c(){t=c("div"),n=c("div"),l=c("div"),o=c("div"),r=c("div"),u=c("div"),a=c("div"),m=c("button"),m.textContent="Load Template",f=b(),E&&E.c(),d=b(),_=c("div"),p=c("button"),h=X("Copy from Instrument"),v=b(),le&&le.c(),g=b(),w=c("button"),D=X("Delete All"),j=b(),H=c("div"),A=c("span"),z=X("CC Total: "),U=c("strong"),M=X(C),L=b(),S=c("div"),q=c("span"),q.textContent="Sort by",Y=b(),Q=c("div"),T=c("button"),T.textContent="CC num",K=b(),te=c("button"),te.textContent="name",F=b(),Z=c("table"),G=c("thead"),G.innerHTML='<tr class="svelte-1ge1ink"><th class="svelte-1ge1ink">Name</th> <th class="svelte-1ge1ink">CC Num</th> <th class="svelte-1ge1ink">Min</th> <th class="svelte-1ge1ink">Max</th> <th class="svelte-1ge1ink">Start</th></tr>',de=b(),P=c("tbody"),V&&V.c(),Te=b(),De=c("tfoot"),De.innerHTML='<tr class="svelte-1ge1ink"><td colspan="5" class="svelte-1ge1ink"></td></tr>',Ce=b(),se=c("div"),_e=b(),Ne=c("div"),fe=c("form"),Je=c("legend"),Ve=X(he),re=b(),we=c("div"),pe=c("div"),pe.innerHTML='<label class="form-label" for="midi-cc-name">Name</label>',J=b(),ue=c("div"),W=c("input"),Se=b(),N=c("div"),ee=c("div"),ee.innerHTML='<label class="form-label" for="midi-cc-num">CC Num</label>',be=b(),ge=c("div"),ie=c("input"),ve=b(),Le=c("div"),Ee=c("input"),Lt=b(),Ze=c("div"),vt=c("div"),vt.innerHTML='<label class="form-label" for="midi-cc-min">Min Value</label>',tt=b(),We=c("div"),Re=c("input"),Nt=b(),kt=c("div"),Be=c("input"),nt=b(),ze=c("div"),Ct=c("div"),Ct.innerHTML='<label class="form-label" for="midi-cc-max">Max Value</label>',Et=b(),wt=c("div"),Ae=c("input"),lt=b(),Xe=c("div"),Ue=c("input"),St=b(),Qe=c("div"),It=c("div"),It.innerHTML='<label class="form-label" for="midi-cc-start">Start Value</label>',ot=b(),Ye=c("div"),Oe=c("input"),jt=b(),yt=c("div"),Pe=c("input"),Ft=b(),mt=c("div"),$e=c("div"),Vt=b(),Ge=c("div"),rt.c(),st=b(),qe&&qe.c(),ye=gt(),i(m,"class","btn btn-sm btn-primary dropdown-toggle"),i(a,"class","dropdown svelte-1ge1ink"),ce(a,"active",e[2]),i(p,"class","btn btn-sm btn-primary dropdown-toggle"),p.disabled=k=e[7].length===0,i(_,"class","dropdown svelte-1ge1ink"),ce(_,"active",e[3]),i(w,"class","btn btn-sm btn-error"),w.disabled=y=e[6].length===0,i(u,"class","cc-footer-left svelte-1ge1ink"),B(A,"margin-left","1rem"),B(A,"white-space","nowrap"),i(H,"class","cc-footer-middle svelte-1ge1ink"),B(q,"margin-right","0.3rem"),B(q,"white-space","nowrap"),i(T,"class","btn btn-sm"),i(te,"class","btn btn-sm"),i(Q,"class","btn-group"),i(S,"class","cc-footer-right svelte-1ge1ink"),i(r,"class","cc-footer-controls svelte-1ge1ink"),i(o,"class","cc-controls-header svelte-1ge1ink"),i(G,"class","cc-table-header svelte-1ge1ink"),i(P,"class","svelte-1ge1ink"),i(De,"class","svelte-1ge1ink"),i(Z,"class","table table-striped table-hover svelte-1ge1ink"),i(l,"class","cc-table-wrapper svelte-1ge1ink"),i(n,"class","column col-6"),i(se,"class","divider-vert col-1"),i(pe,"class","col-3"),i(W,"id","midi-cc-name"),i(W,"class","form-input"),i(W,"type","search"),i(W,"maxlength","6"),i(W,"placeholder","name"),i(ue,"class","col-9"),i(we,"class","form-group"),i(ee,"class","col-3"),i(ie,"id","midi-cc-num"),i(ie,"class","form-input"),i(ie,"type","text"),i(ie,"inputmode","numeric"),i(ie,"min","0"),i(ie,"max","127"),i(ie,"placeholder","cc"),i(ge,"class","col-2"),i(Ee,"class","slider rangeslider"),i(Ee,"type","range"),i(Ee,"min","0"),i(Ee,"max","127"),i(Ee,"aria-label","CC Number slider"),i(Le,"class","col-7"),i(N,"class","form-group"),i(vt,"class","col-3"),i(Re,"id","midi-cc-min"),i(Re,"class","form-input"),i(Re,"type","text"),i(Re,"inputmode","numeric"),i(Re,"min","0"),i(Re,"max","127"),i(Re,"placeholder","min"),i(We,"class","col-2"),i(Be,"class","slider rangeslider"),i(Be,"type","range"),i(Be,"min","0"),i(Be,"max","127"),i(Be,"aria-label","Min Value slider"),i(kt,"class","col-7"),i(Ze,"class","form-group"),i(Ct,"class","col-3"),i(Ae,"id","midi-cc-max"),i(Ae,"class","form-input"),i(Ae,"type","text"),i(Ae,"inputmode","numeric"),i(Ae,"min","0"),i(Ae,"max","127"),i(Ae,"placeholder","max"),i(wt,"class","col-2"),i(Ue,"class","slider rangeslider"),i(Ue,"type","range"),i(Ue,"min","0"),i(Ue,"max","127"),i(Ue,"aria-label","Max Value slider"),i(Xe,"class","col-7"),i(ze,"class","form-group"),i(It,"class","col-3"),i(Oe,"id","midi-cc-start"),i(Oe,"class","form-input"),i(Oe,"type","text"),i(Oe,"inputmode","numeric"),i(Oe,"min","0"),i(Oe,"max","127"),i(Oe,"placeholder","start"),i(Ye,"class","col-2"),i(Pe,"class","slider rangeslider"),i(Pe,"type","range"),i(Pe,"min","0"),i(Pe,"max","127"),i(Pe,"aria-label","Start Value slider"),i(yt,"class","col-7"),i(Qe,"class","form-group"),i($e,"class","col-3"),i(Ge,"class","col-9"),i(mt,"class","form-group"),i(fe,"class","form-horizontal"),i(Ne,"class","column col-5"),i(t,"class","columns")},m($,me){O($,t,me),s(t,n),s(n,l),s(l,o),s(o,r),s(r,u),s(u,a),s(a,m),s(a,f),E&&E.m(a,null),s(u,d),s(u,_),s(_,p),s(p,h),s(_,v),le&&le.m(_,null),s(u,g),s(u,w),s(w,D),s(r,j),s(r,H),s(H,A),s(A,z),s(A,U),s(U,M),s(r,L),s(r,S),s(S,q),s(S,Y),s(S,Q),s(Q,T),s(Q,K),s(Q,te),s(l,F),s(l,Z),s(Z,G),s(Z,de),s(Z,P),V&&V.m(P,null),s(Z,Te),s(Z,De),s(t,Ce),s(t,se),s(t,_e),s(t,Ne),s(Ne,fe),s(fe,Je),s(Je,Ve),s(fe,re),s(fe,we),s(we,pe),s(we,J),s(we,ue),s(ue,W),ne(W,e[1].name),s(fe,Se),s(fe,N),s(N,ee),s(N,be),s(N,ge),s(ge,ie),ne(ie,e[1].cc),s(N,ve),s(N,Le),s(Le,Ee),ne(Ee,e[1].cc),s(fe,Lt),s(fe,Ze),s(Ze,vt),s(Ze,tt),s(Ze,We),s(We,Re),ne(Re,e[1].min),s(Ze,Nt),s(Ze,kt),s(kt,Be),ne(Be,e[1].min),s(fe,nt),s(fe,ze),s(ze,Ct),s(ze,Et),s(ze,wt),s(wt,Ae),ne(Ae,e[1].max),s(ze,lt),s(ze,Xe),s(Xe,Ue),ne(Ue,e[1].max),s(fe,St),s(fe,Qe),s(Qe,It),s(Qe,ot),s(Qe,Ye),s(Ye,Oe),ne(Oe,e[1].start),s(Qe,jt),s(Qe,yt),s(yt,Pe),ne(Pe,e[1].start),s(fe,Ft),s(fe,mt),s(mt,$e),s(mt,Vt),s(mt,Ge),rt.m(Ge,null),O($,st,me),qe&&qe.m($,me),O($,ye,me),it||(je=[I(m,"click",e[22]),I(p,"click",e[25]),I(w,"click",e[13]),I(T,"click",e[28]),I(te,"click",e[29]),I(W,"input",e[31]),I(W,"input",e[32]),I(ie,"input",e[33]),I(ie,"input",e[34]),I(Ee,"change",e[35]),I(Ee,"input",e[35]),I(Ee,"input",e[36]),I(Re,"input",e[37]),I(Re,"input",e[38]),I(Be,"change",e[39]),I(Be,"input",e[39]),I(Be,"input",e[40]),I(Ae,"input",e[41]),I(Ae,"input",e[42]),I(Ue,"change",e[43]),I(Ue,"input",e[43]),I(Ue,"input",e[44]),I(Oe,"input",e[45]),I(Oe,"input",e[46]),I(Pe,"change",e[47]),I(Pe,"input",e[47]),I(Pe,"input",e[48]),I(fe,"submit",$t(e[21]))],it=!0)},p($,me){$[2]?E?E.p($,me):(E=Mn($),E.c(),E.m(a,null)):E&&(E.d(1),E=null),me[0]&4&&ce(a,"active",$[2]),me[0]&128&&k!==(k=$[7].length===0)&&(p.disabled=k),$[3]?le?le.p($,me):(le=Dn($),le.c(),le.m(_,null)):le&&(le.d(1),le=null),me[0]&8&&ce(_,"active",$[3]),me[0]&64&&y!==(y=$[6].length===0)&&(w.disabled=y),me[0]&64&&C!==(C=$[6].length+"")&&ke(M,C),$[6].length>0?V?V.p($,me):(V=Nn($),V.c(),V.m(P,null)):V&&(V.d(1),V=null),me[0]&1&&he!==(he=$[0]?"Edit":"New")&&ke(Ve,he),me[0]&2&&W.value!==$[1].name&&ne(W,$[1].name),me[0]&2&&ie.value!==$[1].cc&&ne(ie,$[1].cc),me[0]&2&&ne(Ee,$[1].cc),me[0]&2&&Re.value!==$[1].min&&ne(Re,$[1].min),me[0]&2&&ne(Be,$[1].min),me[0]&2&&Ae.value!==$[1].max&&ne(Ae,$[1].max),me[0]&2&&ne(Ue,$[1].max),me[0]&2&&Oe.value!==$[1].start&&ne(Oe,$[1].start),me[0]&2&&ne(Pe,$[1].start),Gt===(Gt=_t($))&&rt?rt.p($,me):(rt.d(1),rt=Gt($),rt&&(rt.c(),rt.m(Ge,null))),$[4]?qe?qe.p($,me):(qe=Sn($),qe.c(),qe.m(ye.parentNode,ye)):qe&&(qe.d(1),qe=null)},i:oe,o:oe,d($){$&&(R(t),R(st),R(ye)),E&&E.d(),le&&le.d(),V&&V.d(),rt.d(),qe&&qe.d($),it=!1,Ie(je)}}}function Gl(e,t,n){let l,o,r,u;xe(e,x,N=>n(20,u=N));let a=null,m=ht(),f=!1,d=!1,_=!1,p=null,h=!1,k="";const v=[{file:"midi-cc-general.json",name:"General MIDI",count:13},{file:"midi-cc-synth.json",name:"Synthesizer",count:11},{file:"midi-cc-syntakt.json",name:"Elektron Syntakt",count:16},{file:"midi-cc-analog-four.json",name:"Elektron Analog Four",count:24},{file:"midi-cc-analog-rytm.json",name:"Elektron Analog Rytm",count:28},{file:"midi-cc-digitone.json",name:"Elektron Digitone",count:18},{file:"midi-cc-eventide-space.json",name:"Eventide Space",count:11},{file:"midi-cc-empress-echosystem.json",name:"Empress Echosystem",count:10}];async function g(N,ee=!1){try{const be=`/feature/svelte-migration/templates/${N}`,ve=(await(await fetch(be)).json()).controls.map(Ee=>({...Ee})),Le=v.find(Ee=>Ee.file===N);n(5,k=(Le==null?void 0:Le.name)||N),D(ve,ee),n(2,f=!1)}catch(be){alert("Failed to load template: "+be.message)}}function w(N,ee=!1){const be=N.continuousControls.map(ge=>({...ge}));n(5,k=N.name),D(be,ee),n(3,d=!1)}function D(N,ee=!1){var ge;if((ge=l==null?void 0:l.trackControls)==null?void 0:ge.some(ie=>ie.option==="MIDI CC"&&ie.continuousControl)){p=N,h=ee,n(4,_=!0);return}y(N,ee)}function y(N,ee=!1){let be;if(ee){const ie=new Map;o.forEach(ve=>{ie.set(ve.cc,ve)}),N.forEach(ve=>{ie.set(ve.cc,ve)}),be=Array.from(ie.values()).sort((ve,Le)=>parseInt(ve.cc)-parseInt(Le.cc))}else be=N.sort((ie,ve)=>parseInt(ie.cc)-parseInt(ve.cc));const ge=l.trackControls.map(ie=>{if(ie.option==="MIDI CC"&&ie.ccNumber!==void 0){const ve=be.find(Le=>Le.cc===ie.ccNumber);return{...ie,continuousControl:ve||null}}return ie});x.updateInstrument({continuousControls:be,trackControls:ge}),n(0,a=null),n(1,m=ht())}function j(){n(4,_=!1),y(p,h),p=null,h=!1,n(5,k="")}function H(){n(4,_=!1),p=null,h=!1,n(5,k="")}function A(){o.length!==0&&confirm(`Delete all ${o.length} MIDI CCs? This cannot be undone.`)&&(x.updateInstrument({continuousControls:[]}),n(0,a=null),n(1,m=ht()))}function z(N){n(0,a=N),n(1,m={...N})}function U(N,ee){if(n(1,m={...m,[N]:ee}),a){const be=o.map(ge=>ge===a?{...m}:ge);x.updateInstrument({continuousControls:be}),n(0,a=be.find(ge=>ge.cc===m.cc&&ge.name===m.name))}}function C(){const N=[...o,{...m}];x.updateInstrument({continuousControls:N}),n(1,m=ht()),n(0,a=null)}function M(){if(!a)return;const N=o.filter(ee=>ee!==a);x.updateInstrument({continuousControls:N}),n(1,m=ht()),n(0,a=null)}function L(N){const ee=[...o].sort((be,ge)=>N==="cc"?parseInt(be.cc)-parseInt(ge.cc):be[N].localeCompare(ge[N]));x.updateInstrument({continuousControls:ee})}function S(N){xt.call(this,e,N)}const q=()=>n(2,f=!f),Y=N=>g(N.file,!0),Q=N=>g(N.file,!1),T=()=>n(3,d=!d),K=N=>w(N,!0),te=N=>w(N,!1),F=()=>L("cc"),Z=()=>L("name"),G=N=>z(N);function de(){m.name=this.value,n(1,m)}const P=N=>U("name",N.target.value);function Te(){m.cc=this.value,n(1,m)}const De=N=>{const ee=N.target.value===""?"":parseInt(N.target.value);(ee===""||ee>=0&&ee<=127)&&U("cc",ee)};function Ce(){m.cc=Jt(this.value),n(1,m)}const se=N=>U("cc",parseInt(N.target.value));function _e(){m.min=this.value,n(1,m)}const Ne=N=>{const ee=N.target.value===""?"":parseInt(N.target.value);(ee===""||ee>=0&&ee<=127)&&U("min",ee)};function fe(){m.min=Jt(this.value),n(1,m)}const Je=N=>U("min",parseInt(N.target.value));function he(){m.max=this.value,n(1,m)}const Ve=N=>{const ee=N.target.value===""?"":parseInt(N.target.value);(ee===""||ee>=0&&ee<=127)&&U("max",ee)};function re(){m.max=Jt(this.value),n(1,m)}const we=N=>U("max",parseInt(N.target.value));function pe(){m.start=this.value,n(1,m)}const J=N=>{const ee=N.target.value===""?"":parseInt(N.target.value);(ee===""||ee>=0&&ee<=127)&&U("start",ee)};function ue(){m.start=Jt(this.value),n(1,m)}const W=N=>U("start",parseInt(N.target.value)),Se=()=>{n(0,a=null),n(1,m=ht())};return e.$$.update=()=>{e.$$.dirty[0]&1048576&&n(19,l=u.selectedInstrument),e.$$.dirty[0]&524288&&n(6,o=(l==null?void 0:l.continuousControls)||[]),e.$$.dirty[0]&1572864&&n(7,r=u.instruments.filter(N=>N!==l))},[a,m,f,d,_,k,o,r,v,g,w,j,H,A,z,U,C,M,L,l,u,S,q,Y,Q,T,K,te,F,Z,G,de,P,Te,De,Ce,se,_e,Ne,fe,Je,he,Ve,re,we,pe,J,ue,W,Se]}class Jl extends ft{constructor(t){super(),at(this,t,Gl,ql,et,{},null,[-1,-1,-1])}}function Wl(e,t,n){const l=e.slice();return l[29]=t[n],l}function jn(e,t,n){const l=e.slice();return l[32]=t[n],l}function Rn(e,t,n){const l=e.slice();return l[35]=t[n],l}function An(e,t,n){const l=e.slice();return l[38]=t[n],l[40]=n,l}function Xl(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g;function w(){return e[21](e[40])}function D(){return e[22](e[40])}function y(){return e[23](e[40])}function j(){return e[24](e[40])}function H(){return e[25](e[40])}return{c(){t=c("div"),n=c("button"),l=c("i"),o=b(),r=c("button"),u=c("i"),m=b(),f=c("button"),f.textContent="+",d=b(),_=c("button"),_.textContent="+",p=b(),h=c("button"),h.innerHTML='<i class="icon icon-delete svelte-14dirsn"></i>',k=b(),i(l,"class","icon icon-arrow-up svelte-14dirsn"),i(n,"type","button"),i(n,"class","btn btn-sm btn-action tooltip svelte-14dirsn"),i(n,"data-tooltip","Move row up"),n.disabled=Math.floor(e[40]/6)===0,i(u,"class","icon icon-arrow-down svelte-14dirsn"),i(r,"type","button"),i(r,"class","btn btn-sm btn-action tooltip svelte-14dirsn"),i(r,"data-tooltip","Move row down"),r.disabled=a=Math.floor(e[40]/6)>=Math.ceil(e[2].length/6)-1,i(f,"type","button"),i(f,"class","btn btn-sm btn-action btn-success tooltip svelte-14dirsn"),i(f,"data-tooltip","Insert row above"),i(_,"type","button"),i(_,"class","btn btn-sm btn-action btn-success tooltip svelte-14dirsn"),i(_,"data-tooltip","Insert row below"),i(h,"type","button"),i(h,"class","btn btn-sm btn-action btn-error tooltip svelte-14dirsn"),i(h,"data-tooltip","Delete this row"),i(t,"class","row-actions svelte-14dirsn")},m(A,z){O(A,t,z),s(t,n),s(n,l),s(t,o),s(t,r),s(r,u),s(t,m),s(t,f),s(t,d),s(t,_),s(t,p),s(t,h),s(t,k),v||(g=[I(n,"click",w),I(r,"click",D),I(f,"click",y),I(_,"click",j),I(h,"click",H)],v=!0)},p(A,z){e=A,z[0]&4&&a!==(a=Math.floor(e[40]/6)>=Math.ceil(e[2].length/6)-1)&&(r.disabled=a)},d(A){A&&R(t),v=!1,Ie(g)}}}function On(e){let t,n,l=e[9](e[38])+"",o,r,u,a=e[10](e[38])+"",m,f,d,_,p;function h(){return e[20](e[38])}let k=(e[40]+1)%6===0&&Xl(e);return{c(){t=c("button"),n=c("div"),o=X(l),r=b(),u=c("div"),m=X(a),f=b(),k&&k.c(),d=gt(),i(t,"type","button"),i(t,"class","control"),B(t,"cursor","pointer"),ce(t,"active",e[38]===e[0]),ce(t,"cc",e[38].option===Tt),ce(t,"track",e[38].option===Dt)},m(v,g){O(v,t,g),s(t,n),s(n,o),s(t,r),s(t,u),s(u,m),O(v,f,g),k&&k.m(v,g),O(v,d,g),_||(p=I(t,"click",h),_=!0)},p(v,g){e=v,g[0]&4&&l!==(l=e[9](e[38])+"")&&ke(o,l),g[0]&4&&a!==(a=e[10](e[38])+"")&&ke(m,a),g[0]&5&&ce(t,"active",e[38]===e[0]),g[0]&4&&ce(t,"cc",e[38].option===Tt),g[0]&4&&ce(t,"track",e[38].option===Dt),(e[40]+1)%6===0&&k.p(e,g)},d(v){v&&(R(t),R(f),R(d)),k&&k.d(v),_=!1,p()}}}function Yl(e){let t;return{c(){t=c("legend"),t.textContent="Select a element to Edit"},m(n,l){O(n,t,l)},d(n){n&&R(t)}}}function Zl(e){let t;return{c(){t=c("legend"),t.textContent="Edit"},m(n,l){O(n,t,l)},d(n){n&&R(t)}}}function Hn(e){let t,n,l,o,r,u,a,m,f,d,_=ae(e[4]),p=[];for(let v=0;v<_.length;v+=1)p[v]=zn(Rn(e,_,v));let h=e[1].option===Tt&&Pn(e),k=e[1].option===Dt&&Vn(e);return{c(){t=c("div"),n=c("div"),n.innerHTML='<label class="form-label" for="track-control-type">Type</label>',l=b(),o=c("div"),r=c("select");for(let v=0;v<p.length;v+=1)p[v].c();u=b(),h&&h.c(),a=b(),k&&k.c(),m=gt(),i(n,"class","col-3"),i(r,"id","track-control-type"),i(r,"class","form-select"),e[1].option===void 0&&dt(()=>e[26].call(r)),i(o,"class","col-9"),i(t,"class","form-group")},m(v,g){O(v,t,g),s(t,n),s(t,l),s(t,o),s(o,r);for(let w=0;w<p.length;w+=1)p[w]&&p[w].m(r,null);Fe(r,e[1].option,!0),O(v,u,g),h&&h.m(v,g),O(v,a,g),k&&k.m(v,g),O(v,m,g),f||(d=[I(r,"change",e[26]),I(r,"change",e[6])],f=!0)},p(v,g){if(g[0]&16){_=ae(v[4]);let w;for(w=0;w<_.length;w+=1){const D=Rn(v,_,w);p[w]?p[w].p(D,g):(p[w]=zn(D),p[w].c(),p[w].m(r,null))}for(;w<p.length;w+=1)p[w].d(1);p.length=_.length}g[0]&18&&Fe(r,v[1].option),v[1].option===Tt?h?h.p(v,g):(h=Pn(v),h.c(),h.m(a.parentNode,a)):h&&(h.d(1),h=null),v[1].option===Dt?k?k.p(v,g):(k=Vn(v),k.c(),k.m(m.parentNode,m)):k&&(k.d(1),k=null)},d(v){v&&(R(t),R(u),R(a),R(m)),Ke(p,v),h&&h.d(v),k&&k.d(v),f=!1,Ie(d)}}}function zn(e){let t,n=e[35]+"",l;return{c(){t=c("option"),l=X(n),t.__value=e[35],ne(t,t.__value)},m(o,r){O(o,t,r),s(t,l)},p:oe,d(o){o&&R(t)}}}function Pn(e){let t,n,l,o,r,u,a,m,f,d=ae(e[3]),_=[];for(let p=0;p<d.length;p+=1)_[p]=Fn(jn(e,d,p));return{c(){t=c("div"),n=c("div"),n.innerHTML='<label class="form-label" for="track-control-cc">CC</label>',l=b(),o=c("div"),r=c("select"),u=c("option"),u.textContent="Select CC...";for(let p=0;p<_.length;p+=1)_[p].c();i(n,"class","col-3"),u.__value="",ne(u,u.__value),i(r,"id","track-control-cc"),i(r,"class","form-select"),i(o,"class","col-9"),i(t,"class","form-group")},m(p,h){var k;O(p,t,h),s(t,n),s(t,l),s(t,o),s(o,r),s(r,u);for(let v=0;v<_.length;v+=1)_[v]&&_[v].m(r,null);Fe(r,((k=e[1].continuousControl)==null?void 0:k.cc)||""),m||(f=I(r,"change",e[27]),m=!0)},p(p,h){var k,v;if(h[0]&8){d=ae(p[3]);let g;for(g=0;g<d.length;g+=1){const w=jn(p,d,g);_[g]?_[g].p(w,h):(_[g]=Fn(w),_[g].c(),_[g].m(r,null))}for(;g<_.length;g+=1)_[g].d(1);_.length=d.length}h[0]&18&&a!==(a=((k=p[1].continuousControl)==null?void 0:k.cc)||"")&&Fe(r,((v=p[1].continuousControl)==null?void 0:v.cc)||"")},d(p){p&&R(t),Ke(_,p),m=!1,f()}}}function Fn(e){let t,n=(e[32].label||`CC #${e[32].cc} - ${e[32].name}`)+"",l,o;return{c(){t=c("option"),l=X(n),t.__value=o=e[32].cc,ne(t,t.__value)},m(r,u){O(r,t,u),s(t,l)},p(r,u){u[0]&8&&n!==(n=(r[32].label||`CC #${r[32].cc} - ${r[32].name}`)+"")&&ke(l,n),u[0]&8&&o!==(o=r[32].cc)&&(t.__value=o,ne(t,t.__value))},d(r){r&&R(t)}}}function Vn(e){let t,n,l,o,r,u,a,m=ae(gl),f=[];for(let d=0;d<m.length;d+=1)f[d]=Ql(Wl(e,m,d));return{c(){t=c("div"),n=c("div"),n.innerHTML='<label class="form-label" for="track-control-value">Track CTRL</label>',l=b(),o=c("div"),r=c("select");for(let d=0;d<f.length;d+=1)f[d].c();i(n,"class","col-3"),i(r,"id","track-control-value"),i(r,"class","form-select"),e[1].trackValue===void 0&&dt(()=>e[28].call(r)),i(o,"class","col-9"),i(t,"class","form-group")},m(d,_){O(d,t,_),s(t,n),s(t,l),s(t,o),s(o,r);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(r,null);Fe(r,e[1].trackValue,!0),u||(a=[I(r,"change",e[28]),I(r,"change",e[6])],u=!0)},p(d,_){_[0]&18&&Fe(r,d[1].trackValue)},d(d){d&&R(t),Ke(f,d),u=!1,Ie(a)}}}function Ql(e){let t;return{c(){t=c("option"),t.textContent=`${e[29]}`,t.__value=e[29],ne(t,t.__value)},m(n,l){O(n,t,l)},p:oe,d(n){n&&R(t)}}}function $l(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U=ae(e[2]),C=[];for(let Y=0;Y<U.length;Y+=1)C[Y]=On(An(e,U,Y));function M(Y,Q){return Y[0]?Zl:Yl}let L=M(e),S=L(e),q=e[1]&&Hn(e);return{c(){t=c("div"),n=c("div"),l=c("section");for(let Y=0;Y<C.length;Y+=1)C[Y].c();o=b(),r=c("div"),u=c("button"),a=X("Delete All"),f=b(),d=c("div"),_=b(),p=c("div"),h=c("form"),S.c(),k=b(),q&&q.c(),v=b(),g=c("div"),w=c("button"),w.textContent="Add new page",D=b(),y=c("button"),j=X("Delete last page"),i(l,"id","controls"),i(l,"class","controls-with-actions svelte-14dirsn"),i(u,"class","btn btn-sm btn-error"),u.disabled=m=e[2].length===0,B(r,"margin-top","1rem"),i(n,"class","column col-7"),i(d,"class","divider-vert col-1"),i(h,"class","form-horizontal"),i(w,"class","btn btn-sm"),i(y,"class","btn btn-sm btn-error"),y.disabled=H=e[2].length<=6,i(g,"class","btn-group"),i(p,"class","column col-4"),i(t,"class","columns")},m(Y,Q){O(Y,t,Q),s(t,n),s(n,l);for(let T=0;T<C.length;T+=1)C[T]&&C[T].m(l,null);s(n,o),s(n,r),s(r,u),s(u,a),s(t,f),s(t,d),s(t,_),s(t,p),s(p,h),S.m(h,null),s(h,k),q&&q.m(h,null),s(p,v),s(p,g),s(g,w),s(g,D),s(g,y),s(y,j),A||(z=[I(u,"click",e[14]),I(h,"submit",$t(e[19])),I(w,"click",e[7]),I(y,"click",e[8])],A=!0)},p(Y,Q){if(Q[0]&114213){U=ae(Y[2]);let T;for(T=0;T<U.length;T+=1){const K=An(Y,U,T);C[T]?C[T].p(K,Q):(C[T]=On(K),C[T].c(),C[T].m(l,null))}for(;T<C.length;T+=1)C[T].d(1);C.length=U.length}Q[0]&4&&m!==(m=Y[2].length===0)&&(u.disabled=m),L!==(L=M(Y))&&(S.d(1),S=L(Y),S&&(S.c(),S.m(h,k))),Y[1]?q?q.p(Y,Q):(q=Hn(Y),q.c(),q.m(h,null)):q&&(q.d(1),q=null),Q[0]&4&&H!==(H=Y[2].length<=6)&&(y.disabled=H)},i:oe,o:oe,d(Y){Y&&R(t),Ke(C,Y),S.d(),q&&q.d(),A=!1,Ie(z)}}}function xl(e,t,n){let l,o,r,u;xe(e,x,T=>n(18,u=T));let a=null,m=null;const f=[nn,Tt,Dt];function d(T){n(0,a=T),n(1,m={...T})}function _(){if(!m||!a)return;const T=o.indexOf(a);if(T===-1)return;const K=[...o];K[T]={...m},x.updateInstrument({trackControls:K}),n(0,a=K[T]),n(1,m={...K[T]})}function p(){const T=[...o];for(let K=0;K<6;K++)T.push(bt());x.updateInstrument({trackControls:T})}function h(){if(o.length<=6||!confirm("Delete the last page of 6 controls? This cannot be undone."))return;const T=o.slice(0,-6);x.updateInstrument({trackControls:T})}function k(T){return T.option===nn?" ":T.option===Tt?T.continuousControl?`CC #${T.continuousControl.cc}`:"CC":T.option===Dt?"CTRL":"Unknown"}function v(T){return T.option===nn?" ":T.option===Tt?T.continuousControl?T.continuousControl.name:"":T.option===Dt?T.trackValue:"Unknown"}function g(T){if(!confirm("Delete this row of 6 controls? This cannot be undone."))return;const K=T*6,te=[...o.slice(0,K),...o.slice(K+6)];x.updateInstrument({trackControls:te}),n(0,a=null),n(1,m=null)}function w(T){const K=T*6,te=[...o];for(let F=0;F<6;F++)te.splice(K,0,bt());x.updateInstrument({trackControls:te})}function D(T){const K=(T+1)*6,te=[...o];for(let F=0;F<6;F++)te.splice(K,0,bt());x.updateInstrument({trackControls:te})}function y(){confirm("Delete all track controls? This cannot be undone.")&&(x.updateInstrument({trackControls:[]}),n(0,a=null),n(1,m=null))}function j(T){if(T===0)return;const K=T*6,te=(T-1)*6,F=[...o],Z=F.splice(K,6);F.splice(te,0,...Z),x.updateInstrument({trackControls:F})}function H(T){const K=Math.ceil(o.length/6);if(T>=K-1)return;const te=T*6,F=(T+1)*6,Z=[...o],G=Z.splice(F,6);Z.splice(te,0,...G),x.updateInstrument({trackControls:Z})}function A(T){xt.call(this,e,T)}const z=T=>d(T),U=T=>j(Math.floor(T/6)),C=T=>H(Math.floor(T/6)),M=T=>w(Math.floor(T/6)),L=T=>D(Math.floor(T/6)),S=T=>g(Math.floor(T/6));function q(){m.option=Ht(this),n(1,m),n(4,f)}const Y=T=>{const K=parseInt(T.target.value);n(1,m.continuousControl=r.find(te=>te.cc===K)||null,m),_()};function Q(){m.trackValue=Ht(this),n(1,m),n(4,f)}return e.$$.update=()=>{e.$$.dirty[0]&262144&&n(17,l=u.selectedInstrument),e.$$.dirty[0]&131072&&n(2,o=(l==null?void 0:l.trackControls)||[]),e.$$.dirty[0]&131072&&n(3,r=(l==null?void 0:l.continuousControls)||[])},[a,m,o,r,f,d,_,p,h,k,v,g,w,D,y,j,H,l,u,A,z,U,C,M,L,S,q,Y,Q]}class eo extends ft{constructor(t){super(),at(this,t,xl,$l,et,{},null,[-1,-1])}}function Bn(e,t,n){const l=e.slice();return l[15]=t[n],l}function to(e){let t;return{c(){t=c("tr"),t.innerHTML='<td colspan="3" style="text-align: center; padding: 2rem; color: #999; font-size: 0.85rem;">No row definitions yet. Click &quot;New Row Definition&quot; to add one.</td>',i(t,"class","svelte-1xkwmhp")},m(n,l){O(n,t,l)},p:oe,d(n){n&&R(t)}}}function no(e){let t,n=ae(e[2]),l=[];for(let o=0;o<n.length;o+=1)l[o]=Un(Bn(e,n,o));return{c(){for(let o=0;o<l.length;o+=1)l[o].c();t=gt()},m(o,r){for(let u=0;u<l.length;u+=1)l[u]&&l[u].m(o,r);O(o,t,r)},p(o,r){if(r&13){n=ae(o[2]);let u;for(u=0;u<n.length;u+=1){const a=Bn(o,n,u);l[u]?l[u].p(a,r):(l[u]=Un(a),l[u].c(),l[u].m(t.parentNode,t))}for(;u<l.length;u+=1)l[u].d(1);l.length=n.length}},d(o){o&&R(t),Ke(l,o)}}}function lo(e){let t;return{c(){t=c("span"),t.textContent="",B(t,"color","#999")},m(n,l){O(n,t,l)},d(n){n&&R(t)}}}function oo(e){let t;return{c(){t=c("span"),t.textContent="",B(t,"color","#32b643"),B(t,"font-weight","600")},m(n,l){O(n,t,l)},d(n){n&&R(t)}}}function Un(e){let t,n,l,o=e[15].name+"",r,u,a,m=(e[15].label||"")+"",f,d,_,p,h,k;function v(y,j){return y[15].show?oo:lo}let g=v(e),w=g(e);function D(){return e[10](e[15])}return{c(){t=c("tr"),n=c("td"),l=c("strong"),r=X(o),u=b(),a=c("td"),f=X(m),d=b(),_=c("td"),w.c(),p=b(),B(_,"text-align","center"),B(_,"font-size","0.8rem"),B(t,"cursor","pointer"),i(t,"class","svelte-1xkwmhp"),ce(t,"active",e[15]===e[0])},m(y,j){O(y,t,j),s(t,n),s(n,l),s(l,r),s(t,u),s(t,a),s(a,f),s(t,d),s(t,_),w.m(_,null),s(t,p),h||(k=I(t,"click",D),h=!0)},p(y,j){e=y,j&4&&o!==(o=e[15].name+"")&&ke(r,o),j&4&&m!==(m=(e[15].label||"")+"")&&ke(f,m),g!==(g=v(e))&&(w.d(1),w=g(e),w&&(w.c(),w.m(_,null))),j&5&&ce(t,"active",e[15]===e[0])},d(y){y&&R(t),w.d(),h=!1,k()}}}function so(e){let t,n,l,o,r,u;return{c(){t=c("div"),n=c("button"),n.textContent="+ New Row Definition",l=b(),o=c("p"),o.innerHTML=`Row definitions organize and name the rows in your sequencer.<br/>
            Add rows for different instruments, patterns, or sequences.`,i(n,"class","btn btn-primary btn-lg svelte-1xkwmhp"),B(o,"font-size","0.75rem"),B(o,"color","#999"),B(o,"margin-top","1rem"),B(o,"line-height","1.4"),i(t,"class","empty-state svelte-1xkwmhp")},m(a,m){O(a,t,m),s(t,n),s(t,l),s(t,o),r||(u=I(n,"click",e[6]),r=!0)},p:oe,d(a){a&&R(t),r=!1,u()}}}function io(e){let t,n,l=e[0]?"Edit":"New",o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C,M,L,S,q,Y,Q,T,K,te,F,Z,G,de,P;function Te(se,_e){return se[0]?co:ro}let De=Te(e),Ce=De(e);return{c(){t=c("form"),n=c("legend"),o=X(l),r=b(),u=c("div"),a=c("div"),a.innerHTML='<label class="form-label" for="row-def-name">Name</label>',m=b(),f=c("div"),d=c("input"),_=b(),p=c("small"),p.textContent="Row identifier (max 12 chars)",h=b(),k=c("div"),v=c("div"),v.innerHTML='<label class="form-label" for="row-def-label">Label</label>',g=b(),w=c("div"),D=c("input"),y=b(),j=c("small"),j.textContent="Display label for this row",H=b(),A=c("div"),z=c("div"),z.innerHTML='<label class="form-label">Display</label>',U=b(),C=c("div"),M=c("label"),L=c("input"),S=b(),q=c("i"),Y=X(" Show this row in sequence"),Q=b(),T=c("small"),T.textContent="Toggle visibility in the sequencer display",K=b(),te=c("div"),F=c("div"),Z=b(),G=c("div"),Ce.c(),i(a,"class","col-3"),i(d,"id","row-def-name"),i(d,"class","form-input"),i(d,"type","search"),i(d,"maxlength","12"),i(d,"placeholder","e.g., Bass, Melody, Drums"),B(p,"color","#999"),B(p,"display","block"),B(p,"margin-top","0.2rem"),i(f,"class","col-9"),i(u,"class","form-group"),i(v,"class","col-3"),i(D,"id","row-def-label"),i(D,"class","form-input"),i(D,"type","search"),i(D,"maxlength","16"),i(D,"placeholder","Short description"),B(j,"color","#999"),B(j,"display","block"),B(j,"margin-top","0.2rem"),i(w,"class","col-9"),i(k,"class","form-group"),i(z,"class","col-3"),i(L,"type","checkbox"),i(q,"class","form-icon"),i(M,"class","form-switch svelte-1xkwmhp"),B(T,"color","#999"),B(T,"display","block"),B(T,"margin-top","0.2rem"),i(C,"class","col-9"),i(A,"class","form-group"),i(F,"class","col-3"),i(G,"class","col-9"),i(te,"class","form-group"),i(t,"class","form-horizontal")},m(se,_e){O(se,t,_e),s(t,n),s(n,o),s(t,r),s(t,u),s(u,a),s(u,m),s(u,f),s(f,d),ne(d,e[1].name),s(f,_),s(f,p),s(t,h),s(t,k),s(k,v),s(k,g),s(k,w),s(w,D),ne(D,e[1].label),s(w,y),s(w,j),s(t,H),s(t,A),s(A,z),s(A,U),s(A,C),s(C,M),s(M,L),L.checked=e[1].show,s(M,S),s(M,q),s(M,Y),s(C,Q),s(C,T),s(t,K),s(t,te),s(te,F),s(te,Z),s(te,G),Ce.m(G,null),de||(P=[I(d,"input",e[11]),I(D,"input",e[12]),I(L,"change",e[13]),I(t,"submit",$t(e[9]))],de=!0)},p(se,_e){_e&1&&l!==(l=se[0]?"Edit":"New")&&ke(o,l),_e&2&&d.value!==se[1].name&&ne(d,se[1].name),_e&2&&D.value!==se[1].label&&ne(D,se[1].label),_e&2&&(L.checked=se[1].show),De===(De=Te(se))&&Ce?Ce.p(se,_e):(Ce.d(1),Ce=De(se),Ce&&(Ce.c(),Ce.m(G,null)))},d(se){se&&R(t),Ce.d(),de=!1,Ie(P)}}}function ro(e){let t,n,l;return{c(){t=c("button"),t.textContent="Add Row",i(t,"type","button"),i(t,"class","btn btn-sm btn-primary tooltip"),i(t,"data-tooltip","Add this row definition.")},m(o,r){O(o,t,r),n||(l=I(t,"click",e[4]),n=!0)},p:oe,d(o){o&&R(t),n=!1,l()}}}function co(e){let t,n,l,o,r;return{c(){t=c("button"),t.textContent="Delete",n=b(),l=c("button"),l.textContent="Cancel",i(t,"type","button"),i(t,"class","btn btn-sm tooltip"),i(t,"data-tooltip","Delete this row definition."),i(l,"type","button"),i(l,"class","btn btn-sm"),B(l,"margin-left","0.5rem")},m(u,a){O(u,t,a),O(u,n,a),O(u,l,a),o||(r=[I(t,"click",e[5]),I(l,"click",e[14])],o=!0)},p:oe,d(u){u&&(R(t),R(n),R(l)),o=!1,Ie(r)}}}function uo(e){let t,n,l,o,r,u,a,m,f,d,_,p=e[2].length+"",h,k,v=e[2].length!==1?"s":"",g,w,D,y,j;function H(L,S){return L[2].length>0?no:to}let A=H(e),z=A(e);function U(L,S){return L[1]?io:so}let C=U(e),M=C(e);return{c(){t=c("div"),n=c("div"),l=c("table"),o=c("thead"),o.innerHTML='<tr class="svelte-1xkwmhp"><th>Name</th> <th>Label</th> <th style="width: 60px;">Visible</th></tr>',r=b(),u=c("tbody"),z.c(),a=b(),m=c("tfoot"),f=c("tr"),d=c("td"),_=c("span"),h=X(p),k=X(` 
              Row Definition`),g=X(v),w=b(),D=c("div"),y=b(),j=c("div"),M.c(),i(_,"class","text-primary"),B(_,"font-weight","600"),i(d,"colspan","3"),i(f,"class","svelte-1xkwmhp"),i(l,"class","table table-striped table-hover tablescroll svelte-1xkwmhp"),i(n,"class","column col-7"),i(D,"class","divider-vert col-1"),i(j,"class","column col-4"),i(t,"class","columns col-oneline")},m(L,S){O(L,t,S),s(t,n),s(n,l),s(l,o),s(l,r),s(l,u),z.m(u,null),s(l,a),s(l,m),s(m,f),s(f,d),s(d,_),s(_,h),s(d,k),s(d,g),s(t,w),s(t,D),s(t,y),s(t,j),M.m(j,null)},p(L,[S]){A===(A=H(L))&&z?z.p(L,S):(z.d(1),z=A(L),z&&(z.c(),z.m(u,null))),S&4&&p!==(p=L[2].length+"")&&ke(h,p),S&4&&v!==(v=L[2].length!==1?"s":"")&&ke(g,v),C===(C=U(L))&&M?M.p(L,S):(M.d(1),M=C(L),M&&(M.c(),M.m(j,null)))},i:oe,o:oe,d(L){L&&R(t),z.d(),M.d()}}}function ao(e,t,n){let l,o,r;xe(e,x,D=>n(8,r=D));let u=null,a=null;function m(D){n(0,u=D),n(1,a={...D})}function f(){if(a)if(u){const D=o.indexOf(u),y=[...o];y[D]={...a},x.updateInstrument({rowDefinitions:y}),n(0,u=y[D]),n(1,a={...y[D]})}else{const D=[...o,{...a}];x.updateInstrument({rowDefinitions:D}),n(0,u=null),n(1,a=null)}}function d(){if(!u)return;const D=o.filter(y=>y!==u);x.updateInstrument({rowDefinitions:D}),n(0,u=null),n(1,a=null)}function _(){n(0,u=null),n(1,a=tl())}function p(D){xt.call(this,e,D)}const h=D=>m(D);function k(){a.name=this.value,n(1,a)}function v(){a.label=this.value,n(1,a)}function g(){a.show=this.checked,n(1,a)}const w=()=>{n(0,u=null),n(1,a=null)};return e.$$.update=()=>{e.$$.dirty&256&&n(7,l=r.selectedInstrument),e.$$.dirty&128&&n(2,o=(l==null?void 0:l.rowDefinitions)||[]),e.$$.dirty&3&&a&&u&&f()},[u,a,o,m,f,d,_,l,r,p,h,k,v,g,w]}class fo extends ft{constructor(t){super(),at(this,t,ao,uo,et,{})}}function Kn(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D,y,j,H,A,z,U,C,M,L,S,q,Y,Q;const T=[ho,_o,po,mo],K=[];function te(F,Z){return F[0]==="settings"?0:F[0]==="cc"?1:F[0]==="trackControl"?2:F[0]==="rowDefs"?3:-1}return~(M=te(e))&&(L=K[M]=T[M](e)),q=rl(e[3][0]),{c(){var F,Z,G;t=c("div"),n=c("input"),l=b(),o=c("input"),r=b(),u=c("input"),a=b(),m=c("input"),f=b(),d=c("ul"),_=c("li"),_.innerHTML='<label for="instrumentSettings"><i class="icon icon-menu"></i> Settings</label>',p=b(),h=c("li"),k=c("label"),k.innerHTML='<i class="icon icon-bookmark"></i> Midi CC&#39;s',g=b(),w=c("li"),D=c("label"),D.innerHTML='<i class="icon icon-arrow-right"></i> Track Control',j=b(),H=c("li"),A=c("label"),A.innerHTML='<i class="icon icon-resize-vert"></i> Row Definitions',U=b(),C=c("div"),L&&L.c(),i(n,"type","radio"),i(n,"id","instrumentSettings"),i(n,"name","tabs"),i(n,"class","tab-locator"),n.hidden=!0,n.__value="settings",ne(n,n.__value),i(o,"type","radio"),i(o,"id","instrumentCC"),i(o,"name","tabs"),i(o,"class","tab-locator"),o.hidden=!0,o.__value="cc",ne(o,o.__value),i(u,"type","radio"),i(u,"id","instrumentTrackControl"),i(u,"name","tabs"),i(u,"class","tab-locator"),u.hidden=!0,u.__value="trackControl",ne(u,u.__value),i(m,"type","radio"),i(m,"id","instrumentRowDefs"),i(m,"name","tabs"),i(m,"class","tab-locator"),m.hidden=!0,m.__value="rowDefs",ne(m,m.__value),i(_,"class","tab-item"),ce(_,"active",e[0]==="settings"),i(k,"for","instrumentCC"),i(h,"class","tab-item badge"),i(h,"data-badge",v=((F=e[1].selectedInstrument.continuousControls)==null?void 0:F.length)||0),ce(h,"active",e[0]==="cc"),i(D,"for","instrumentTrackControl"),i(w,"class","tab-item badge"),i(w,"data-badge",y=((Z=e[1].selectedInstrument.trackControls)==null?void 0:Z.length)||0),ce(w,"active",e[0]==="trackControl"),i(A,"for","instrumentRowDefs"),i(H,"class","tab-item badge"),i(H,"data-badge",z=((G=e[1].selectedInstrument.rowDefinitions)==null?void 0:G.length)||0),ce(H,"active",e[0]==="rowDefs"),i(d,"class","tab tab-block tabs-container svelte-15pdtcs"),i(C,"class","tabs"),q.p(n,o,u,m)},m(F,Z){O(F,t,Z),s(t,n),n.checked=n.__value===e[0],s(t,l),s(t,o),o.checked=o.__value===e[0],s(t,r),s(t,u),u.checked=u.__value===e[0],s(t,a),s(t,m),m.checked=m.__value===e[0],s(t,f),s(t,d),s(d,_),s(d,p),s(d,h),s(h,k),s(d,g),s(d,w),s(w,D),s(d,j),s(d,H),s(H,A),s(t,U),s(t,C),~M&&K[M].m(C,null),S=!0,Y||(Q=[I(n,"change",e[2]),I(o,"change",e[4]),I(u,"change",e[5]),I(m,"change",e[6])],Y=!0)},p(F,Z){var de,P,Te;Z&1&&(n.checked=n.__value===F[0]),Z&1&&(o.checked=o.__value===F[0]),Z&1&&(u.checked=u.__value===F[0]),Z&1&&(m.checked=m.__value===F[0]),(!S||Z&1)&&ce(_,"active",F[0]==="settings"),(!S||Z&2&&v!==(v=((de=F[1].selectedInstrument.continuousControls)==null?void 0:de.length)||0))&&i(h,"data-badge",v),(!S||Z&1)&&ce(h,"active",F[0]==="cc"),(!S||Z&2&&y!==(y=((P=F[1].selectedInstrument.trackControls)==null?void 0:P.length)||0))&&i(w,"data-badge",y),(!S||Z&1)&&ce(w,"active",F[0]==="trackControl"),(!S||Z&2&&z!==(z=((Te=F[1].selectedInstrument.rowDefinitions)==null?void 0:Te.length)||0))&&i(H,"data-badge",z),(!S||Z&1)&&ce(H,"active",F[0]==="rowDefs");let G=M;M=te(F),M!==G&&(L&&(Yt(),He(K[G],1,1,()=>{K[G]=null}),Zt()),~M?(L=K[M],L||(L=K[M]=T[M](F),L.c()),Me(L,1),L.m(C,null)):L=null)},i(F){S||(Me(L),S=!0)},o(F){He(L),S=!1},d(F){F&&R(t),~M&&K[M].d(),q.r(),Y=!1,Ie(Q)}}}function mo(e){let t,n;return t=new fo({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function po(e){let t,n;return t=new eo({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function _o(e){let t,n;return t=new Jl({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function ho(e){let t,n;return t=new Bl({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function bo(e){let t,n,l=e[1].selectedInstrument&&Kn(e);return{c(){l&&l.c(),t=gt()},m(o,r){l&&l.m(o,r),O(o,t,r),n=!0},p(o,[r]){o[1].selectedInstrument?l?(l.p(o,r),r&2&&Me(l,1)):(l=Kn(o),l.c(),Me(l,1),l.m(t.parentNode,t)):l&&(Yt(),He(l,1,1,()=>{l=null}),Zt())},i(o){n||(Me(l),n=!0)},o(o){He(l),n=!1},d(o){o&&R(t),l&&l.d(o)}}}function go(e,t,n){let l;xe(e,x,d=>n(1,l=d));let o="settings";const r=[[]];function u(){o=this.__value,n(0,o)}function a(){o=this.__value,n(0,o)}function m(){o=this.__value,n(0,o)}function f(){o=this.__value,n(0,o)}return[o,l,u,r,a,m,f]}class vo extends ft{constructor(t){super(),at(this,t,go,bo,et,{})}}function qn(e,t,n){const l=e.slice();return l[13]=t[n],l[15]=n,l}function ko(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w,D;return{c(){t=c("div"),n=c("button"),l=b(),o=c("div"),r=c("div"),r.innerHTML='<div class="modal-title h6" style="font-size: 0.8rem;">Import Instrument</div>',u=b(),a=c("div"),a.innerHTML='<div class="content"><p style="font-size: 0.75rem;">How would you like to import this instrument?</p></div>',m=b(),f=c("div"),d=c("button"),d.textContent="As New Instrument",_=b(),p=c("button"),h=X("Merge with Current"),v=b(),g=c("button"),g.textContent="Cancel",i(n,"class","modal-overlay"),i(n,"aria-label","Close modal"),i(n,"type","button"),i(r,"class","modal-header"),i(a,"class","modal-body"),i(d,"class","btn btn-sm svelte-uz7jv"),B(d,"font-size","0.75rem"),i(p,"class","btn btn-sm svelte-uz7jv"),p.disabled=k=!e[3].selectedInstrument,B(p,"font-size","0.75rem"),i(g,"class","btn btn-sm svelte-uz7jv"),B(g,"font-size","0.75rem"),i(f,"class","modal-footer svelte-uz7jv"),i(o,"class","modal-container svelte-uz7jv"),i(o,"role","document"),i(t,"class","modal modal-sm active svelte-uz7jv"),i(t,"id","importInstrumentSelection")},m(y,j){O(y,t,j),s(t,n),s(t,l),s(t,o),s(o,r),s(o,u),s(o,a),s(o,m),s(o,f),s(f,d),s(f,_),s(f,p),s(p,h),s(f,v),s(f,g),w||(D=[I(n,"click",e[7]),I(n,"keydown",e[10]),I(d,"click",e[11]),I(p,"click",e[12]),I(g,"click",e[7])],w=!0)},p(y,j){j&8&&k!==(k=!y[3].selectedInstrument)&&(p.disabled=k)},d(y){y&&R(t),w=!1,Ie(D)}}}function Co(e){let t,n,l,o,r,u,a,m,f,d,_,p,h,k,v,g,w=e[1]!==1?"s":"",D,y,j,H,A,z,U=ae(e[0].instruments),C=[];for(let M=0;M<U.length;M+=1)C[M]=Gn(qn(e,U,M));return{c(){t=c("div"),n=c("button"),l=b(),o=c("div"),r=c("div"),r.innerHTML='<div class="modal-title h6" style="font-size: 0.8rem;">Select Instruments to Import</div>',u=b(),a=c("div"),m=c("div"),f=c("p"),f.textContent="Select which instruments to import:",d=b();for(let M=0;M<C.length;M+=1)C[M].c();_=b(),p=c("div"),h=c("button"),k=X("Import "),v=X(e[1]),g=X(" Instrument"),D=X(w),j=b(),H=c("button"),H.textContent="Cancel",i(n,"class","modal-overlay"),i(n,"aria-label","Close modal"),i(n,"type","button"),i(r,"class","modal-header"),B(f,"font-size","0.75rem"),B(f,"margin-bottom","0.5rem"),i(m,"class","content"),B(m,"max-height","300px"),B(m,"overflow-y","auto"),i(a,"class","modal-body"),i(h,"class","btn btn-sm btn-primary svelte-uz7jv"),h.disabled=y=e[1]===0,B(h,"font-size","0.75rem"),i(H,"class","btn btn-sm svelte-uz7jv"),B(H,"font-size","0.75rem"),i(p,"class","modal-footer svelte-uz7jv"),i(o,"class","modal-container svelte-uz7jv"),i(o,"role","document"),i(t,"class","modal modal-sm active svelte-uz7jv"),i(t,"id","importInstrumentSelection")},m(M,L){O(M,t,L),s(t,n),s(t,l),s(t,o),s(o,r),s(o,u),s(o,a),s(a,m),s(m,f),s(m,d);for(let S=0;S<C.length;S+=1)C[S]&&C[S].m(m,null);s(o,_),s(o,p),s(p,h),s(h,k),s(h,v),s(h,g),s(h,D),s(p,j),s(p,H),A||(z=[I(n,"click",e[7]),I(n,"keydown",e[8]),I(h,"click",e[5]),I(H,"click",e[7])],A=!0)},p(M,L){if(L&65){U=ae(M[0].instruments);let S;for(S=0;S<U.length;S+=1){const q=qn(M,U,S);C[S]?C[S].p(q,L):(C[S]=Gn(q),C[S].c(),C[S].m(m,null))}for(;S<C.length;S+=1)C[S].d(1);C.length=U.length}L&2&&ke(v,M[1]),L&2&&w!==(w=M[1]!==1?"s":"")&&ke(D,w),L&2&&y!==(y=M[1]===0)&&(h.disabled=y)},d(M){M&&R(t),Ke(C,M),A=!1,Ie(z)}}}function Gn(e){let t,n,l,o,r,u,a=e[13].name+"",m,f,d,_;function p(){return e[9](e[15])}return{c(){t=c("label"),n=c("input"),o=b(),r=c("i"),u=b(),m=X(a),f=b(),i(n,"type","checkbox"),n.checked=l=e[13].selected,i(r,"class","form-icon"),i(t,"class","form-checkbox"),B(t,"display","block"),B(t,"margin-bottom","0.3rem"),B(t,"font-size","0.75rem")},m(h,k){O(h,t,k),s(t,n),s(t,o),s(t,r),s(t,u),s(t,m),s(t,f),d||(_=I(n,"change",p),d=!0)},p(h,k){e=h,k&1&&l!==(l=e[13].selected)&&(n.checked=l),k&1&&a!==(a=e[13].name+"")&&ke(m,a)},d(h){h&&R(t),d=!1,_()}}}function wo(e){let t;function n(r,u){return r[2]?Co:ko}let l=n(e),o=l(e);return{c(){o.c(),t=gt()},m(r,u){o.m(r,u),O(r,t,u)},p(r,[u]){l===(l=n(r))&&o?o.p(r,u):(o.d(1),o=l(r),o&&(o.c(),o.m(t.parentNode,t)))},i:oe,o:oe,d(r){r&&R(t),o.d(r)}}}function Io(e,t,n){let l,o,r,u;xe(e,Ut,g=>n(0,r=g)),xe(e,x,g=>n(3,u=g));function a(g){if(!u.importInstrumentData)return;const w=Sl(u.importInstrumentData,g);w&&(g==="new"?x.addInstrument(w):g==="merge"&&x.updateInstrument({continuousControls:w.continuousControls,rowDefinitions:w.rowDefinitions})),x.clearImportData(),Pt.set(!1)}function m(){r&&(El(r.instruments),Ut.set(null),Pt.set(!1))}function f(g){Ut.update(w=>(w&&(w.instruments[g].selected=!w.instruments[g].selected),w))}function d(){x.clearImportData(),Ut.set(null),Pt.set(!1)}const _=g=>g.key==="Enter"&&d(),p=g=>f(g),h=g=>g.key==="Enter"&&d(),k=()=>a("new"),v=()=>a("merge");return e.$$.update=()=>{e.$$.dirty&1&&n(2,l=r&&r.instruments.length>1),e.$$.dirty&1&&n(1,o=r?r.instruments.filter(g=>g.selected).length:0)},[r,o,l,u,a,m,f,d,_,p,h,k,v]}class yo extends ft{constructor(t){super(),at(this,t,Io,wo,et,{})}}function Mo(e){let t;return{c(){t=c("footer"),t.innerHTML='<span class="footer-text svelte-15361xw">Redesigned and optimised by <strong class="svelte-15361xw">A7K8 - Michael Bennett</strong></span>',i(t,"class","app-footer svelte-15361xw")},m(n,l){O(n,t,l)},p:oe,i:oe,o:oe,d(n){n&&R(t)}}}class To extends ft{constructor(t){super(),at(this,t,null,Mo,et,{})}}function Jn(e){let t,n;return t=new vo({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function Wn(e){let t,n;return t=new yo({}),{c(){pt(t.$$.fragment)},m(l,o){ct(t,l,o),n=!0},i(l){n||(Me(t.$$.fragment,l),n=!0)},o(l){He(t.$$.fragment,l),n=!1},d(l){ut(t,l)}}}function Do(e){let t,n,l,o,r,u,a,m,f;t=new Ml({}),l=new Al({});let d=e[0].selectedInstrument&&Jn(),_=e[1]&&Wn();return m=new To({}),{c(){pt(t.$$.fragment),n=b(),pt(l.$$.fragment),o=b(),r=c("main"),d&&d.c(),u=b(),_&&_.c(),a=b(),pt(m.$$.fragment)},m(p,h){ct(t,p,h),O(p,n,h),ct(l,p,h),O(p,o,h),O(p,r,h),d&&d.m(r,null),s(r,u),_&&_.m(r,null),O(p,a,h),ct(m,p,h),f=!0},p(p,[h]){p[0].selectedInstrument?d?h&1&&Me(d,1):(d=Jn(),d.c(),Me(d,1),d.m(r,u)):d&&(Yt(),He(d,1,1,()=>{d=null}),Zt()),p[1]?_?h&2&&Me(_,1):(_=Wn(),_.c(),Me(_,1),_.m(r,null)):_&&(Yt(),He(_,1,1,()=>{_=null}),Zt())},i(p){f||(Me(t.$$.fragment,p),Me(l.$$.fragment,p),Me(d),Me(_),Me(m.$$.fragment,p),f=!0)},o(p){He(t.$$.fragment,p),He(l.$$.fragment,p),He(d),He(_),He(m.$$.fragment,p),f=!1},d(p){p&&(R(n),R(o),R(r),R(a)),ut(t,p),ut(l,p),d&&d.d(),_&&_.d(),ut(m,p)}}}function Lo(e,t,n){let l,o;return xe(e,x,r=>n(0,l=r)),xe(e,Pt,r=>n(1,o=r)),[l,o]}class No extends ft{constructor(t){super(),at(this,t,Lo,Do,et,{})}}new No({target:document.getElementById("app")});
